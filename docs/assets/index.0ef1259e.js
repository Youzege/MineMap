import{u as Ze,l as Qe,E as $t,B as Xr,h as pt,i as q,j as wi,k as Ur,m as mt,I as H,n as er,p as ot,q as Ot,s as Ht,v as Vt,w as jt,x as $r,L as Hr,y as Vr,z as jr,R as zr,G as R,A as he,D as Oi,F as Ri,H as Jr,J as me,K as zt,N as Jt,O as Ce,P as qr,Q as ai,S as Kr,T as Z,U as vt,V as qt,W as ye,X as ir,Y as Zr,Z as X,$ as Qr,a0 as yt,a1 as xe,a2 as tn,a3 as en,a4 as rn,a5 as Se,a6 as Ct,a7 as ti,a8 as nn,a9 as Ut,aa as an,ab as Li,ac as Ie,ad as sn,ae as ei,af as Ee,ag as on,ah as hn,ai as ln,aj as un,ak as Di,al as Fi,am as le,an as ue,ao as fn,ap as cn,aq as dn,ar as pn,c as Yt,as as _n,at as vn,au as gn,av as mn,aw as yn,ax as rr,ay as nr,az as xn,aA as Sn,aB as In,aC as En,aD as Ai,aE as Tn,aF as Cn,aG as wn,aH as On,aI as Rn,f as Ln,_ as Dn,d as Fn,e as An,g as Mn}from"./ZeView.8890a979.js";import"./index.83bc55db.js";import{G as Pn,y as kn,x as Bn,D as Nn,o as bn,c as Gn,w as Xe,d as xt}from"./vendor.c825c0be.js";var Nt={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"},Yn=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Wn=function(n){Yn(e,n);function e(t){var i=n.call(this)||this;if(i.on,i.once,i.un,i.id_=void 0,i.geometryName_="geometry",i.style_=null,i.styleFunction_=void 0,i.geometryChangeKey_=null,i.addChangeListener(i.geometryName_,i.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){var r=t;i.setGeometry(r)}else{var a=t;i.setProperties(a)}return i}return e.prototype.clone=function(){var t=new e(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var r=this.getStyle();return r&&t.setStyle(r),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(Ze(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=Qe(t,$t.CHANGE,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?Xn(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()},e}(Xr);function Xn(n){if(typeof n=="function")return n;var e;if(Array.isArray(n))e=n;else{pt(typeof n.getZIndex=="function",41);var t=n;e=[t]}return function(){return e}}var Un=Wn;function $n(n,e,t,i){for(var r=n[e],a=n[e+1],s=0,o=e+i;o<t;o+=i){var h=n[o],l=n[o+1];s+=Math.sqrt((h-r)*(h-r)+(l-a)*(l-a)),r=h,a=l}return s}function Hn(n,e,t,i,r){ar(n,e,t||0,i||n.length-1,r||Vn)}function ar(n,e,t,i,r){for(;i>t;){if(i-t>600){var a=i-t+1,s=e-t+1,o=Math.log(a),h=.5*Math.exp(2*o/3),l=.5*Math.sqrt(o*h*(a-h)/a)*(s-a/2<0?-1:1),u=Math.max(t,Math.floor(e-s*h/a+l)),f=Math.min(i,Math.floor(e+(a-s)*h/a+l));ar(n,e,u,f,r)}var c=n[e],d=t,p=i;for(bt(n,t,e),r(n[i],c)>0&&bt(n,t,i);d<p;){for(bt(n,d,p),d++,p--;r(n[d],c)<0;)d++;for(;r(n[p],c)>0;)p--}r(n[t],c)===0?bt(n,t,p):(p++,bt(n,p,i)),p<=e&&(t=p+1),e<=p&&(i=p-1)}}function bt(n,e,t){var i=n[e];n[e]=n[t],n[t]=i}function Vn(n,e){return n<e?-1:n>e?1:0}class sr{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!ce(e,t))return i;const r=this.toBBox,a=[];for(;t;){for(let s=0;s<t.children.length;s++){const o=t.children[s],h=t.leaf?r(o):o;ce(e,h)&&(t.leaf?i.push(o):$e(e,h)?this._all(o,i):a.push(o))}t=a.pop()}return i}collides(e){let t=this.data;if(!ce(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const a=t.children[r],s=t.leaf?this.toBBox(a):a;if(ce(e,s)){if(t.leaf||$e(e,s))return!0;i.push(a)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=wt([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),a=[],s=[];let o,h,l;for(;i||a.length;){if(i||(i=a.pop(),h=a[a.length-1],o=s.pop(),l=!0),i.leaf){const u=jn(e,i.children,t);if(u!==-1)return i.children.splice(u,1),a.push(i),this._condense(a),this}!l&&!i.leaf&&$e(i,r)?(a.push(i),s.push(o),o=0,h=i,i=i.children[0]):h?(o++,i=h.children[o],l=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const a=i-t+1;let s=this._maxEntries,o;if(a<=s)return o=wt(e.slice(t,i+1)),St(o,this.toBBox),o;r||(r=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,r-1))),o=wt([]),o.leaf=!1,o.height=r;const h=Math.ceil(a/s),l=h*Math.ceil(Math.sqrt(s));Mi(e,t,i,l,this.compareMinX);for(let u=t;u<=i;u+=l){const f=Math.min(u+l-1,i);Mi(e,u,f,h,this.compareMinY);for(let c=u;c<=f;c+=h){const d=Math.min(c+h-1,f);o.children.push(this._build(e,c,d,r-1))}}return St(o,this.toBBox),o}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let a=1/0,s=1/0,o;for(let h=0;h<t.children.length;h++){const l=t.children[h],u=Ue(l),f=qn(e,l)-u;f<s?(s=f,a=u<a?u:a,o=l):f===s&&u<a&&(a=u,o=l)}t=o||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),a=[],s=this._chooseSubtree(r,this.data,t,a);for(s.children.push(e),Xt(s,r);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(r,a,t)}_split(e,t){const i=e[t],r=i.children.length,a=this._minEntries;this._chooseSplitAxis(i,a,r);const s=this._chooseSplitIndex(i,a,r),o=wt(i.children.splice(s,i.children.length-s));o.height=i.height,o.leaf=i.leaf,St(i,this.toBBox),St(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(i,o)}_splitRoot(e,t){this.data=wt([e,t]),this.data.height=e.height+1,this.data.leaf=!1,St(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,a=1/0,s=1/0;for(let o=t;o<=i-t;o++){const h=Wt(e,0,o,this.toBBox),l=Wt(e,o,i,this.toBBox),u=Kn(h,l),f=Ue(h)+Ue(l);u<a?(a=u,r=o,s=f<s?f:s):u===a&&f<s&&(s=f,r=o)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:zn,a=e.leaf?this.compareMinY:Jn,s=this._allDistMargin(e,t,i,r),o=this._allDistMargin(e,t,i,a);s<o&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const a=this.toBBox,s=Wt(e,0,t,a),o=Wt(e,i-t,i,a);let h=fe(s)+fe(o);for(let l=t;l<i-t;l++){const u=e.children[l];Xt(s,e.leaf?a(u):u),h+=fe(s)}for(let l=i-t-1;l>=t;l--){const u=e.children[l];Xt(o,e.leaf?a(u):u),h+=fe(o)}return h}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Xt(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():St(e[t],this.toBBox)}}function jn(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function St(n,e){Wt(n,0,n.children.length,e,n)}function Wt(n,e,t,i,r){r||(r=wt(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let a=e;a<t;a++){const s=n.children[a];Xt(r,n.leaf?i(s):s)}return r}function Xt(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function zn(n,e){return n.minX-e.minX}function Jn(n,e){return n.minY-e.minY}function Ue(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function fe(n){return n.maxX-n.minX+(n.maxY-n.minY)}function qn(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function Kn(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),a=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,a-i)}function $e(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function ce(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function wt(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Mi(n,e,t,i,r){const a=[e,t];for(;a.length;){if(t=a.pop(),e=a.pop(),t-e<=i)continue;const s=e+Math.ceil((t-e)/i/2)*i;Hn(n,s,e,t,r),a.push(e,s,s,t)}}var Zn=function(){function n(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=wi(e.scale),this.displacement_=e.displacement}return n.prototype.clone=function(){var e=this.getScale();return new n({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},n.prototype.getOpacity=function(){return this.opacity_},n.prototype.getRotateWithView=function(){return this.rotateWithView_},n.prototype.getRotation=function(){return this.rotation_},n.prototype.getScale=function(){return this.scale_},n.prototype.getScaleArray=function(){return this.scaleArray_},n.prototype.getDisplacement=function(){return this.displacement_},n.prototype.getAnchor=function(){return q()},n.prototype.getImage=function(e){return q()},n.prototype.getHitDetectionImage=function(){return q()},n.prototype.getPixelRatio=function(e){return 1},n.prototype.getImageState=function(){return q()},n.prototype.getImageSize=function(){return q()},n.prototype.getOrigin=function(){return q()},n.prototype.getSize=function(){return q()},n.prototype.setDisplacement=function(e){this.displacement_=e},n.prototype.setOpacity=function(e){this.opacity_=e},n.prototype.setRotateWithView=function(e){this.rotateWithView_=e},n.prototype.setRotation=function(e){this.rotation_=e},n.prototype.setScale=function(e){this.scale_=e,this.scaleArray_=wi(e)},n.prototype.listenImageChange=function(e){q()},n.prototype.load=function(){q()},n.prototype.unlistenImageChange=function(e){q()},n}(),or=Zn;function tt(n){return Array.isArray(n)?Ur(n):n}var Qn=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ta=function(n){Qn(e,n);function e(t){var i=this,r=t.rotateWithView!==void 0?t.rotateWithView:!1;return i=n.call(this,{opacity:1,rotateWithView:r,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0]})||this,i.canvas_=void 0,i.hitDetectionCanvas_=null,i.fill_=t.fill!==void 0?t.fill:null,i.origin_=[0,0],i.points_=t.points,i.radius_=t.radius!==void 0?t.radius:t.radius1,i.radius2_=t.radius2,i.angle_=t.angle!==void 0?t.angle:0,i.stroke_=t.stroke!==void 0?t.stroke:null,i.size_=null,i.renderOptions_=null,i.render(),i}return e.prototype.clone=function(){var t=this.getScale(),i=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice()});return i.setOpacity(this.getOpacity()),i},e.prototype.getAnchor=function(){var t=this.size_;if(!t)return null;var i=this.getDisplacement();return[t[0]/2-i[0],t[1]/2+i[1]]},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_},e.prototype.getImage=function(t){var i=this.canvas_[t];if(!i){var r=this.renderOptions_,a=mt(r.size*t,r.size*t);this.draw_(r,a,t),i=a.canvas,this.canvas_[t]=i}return i},e.prototype.getPixelRatio=function(t){return t},e.prototype.getImageSize=function(){return this.size_},e.prototype.getImageState=function(){return H.LOADED},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t){},e.prototype.calculateLineJoinSize_=function(t,i,r){if(i===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return i;var a=this.radius_,s=this.radius2_===void 0?a:this.radius2_;if(a<s){var o=a;a=s,s=o}var h=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/h,u=s*Math.sin(l),f=Math.sqrt(s*s-u*u),c=a-f,d=Math.sqrt(u*u+c*c),p=d/u;if(t==="miter"&&p<=r)return p*i;var _=i/2/p,v=i/2*(c/d),g=Math.sqrt((a+_)*(a+_)+v*v),m=g-a;if(this.radius2_===void 0||t==="bevel")return m*2;var x=a*Math.sin(l),S=Math.sqrt(a*a-x*x),I=s-S,C=Math.sqrt(x*x+I*I),O=C/x;if(O<=r){var T=O*i/2-s-a;return 2*Math.max(m,T)}return m*2},e.prototype.createRenderOptions=function(){var t=Ot,i=0,r=null,a=0,s,o=0;this.stroke_&&(s=this.stroke_.getColor(),s===null&&(s=Ht),s=tt(s),o=this.stroke_.getWidth(),o===void 0&&(o=Vt),r=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset(),t=this.stroke_.getLineJoin(),t===void 0&&(t=Ot),i=this.stroke_.getMiterLimit(),i===void 0&&(i=jt));var h=this.calculateLineJoinSize_(t,o,i),l=Math.max(this.radius_,this.radius2_||0),u=Math.ceil(2*l+h);return{strokeStyle:s,strokeWidth:o,size:u,lineDash:r,lineDashOffset:a,lineJoin:t,miterLimit:i}},e.prototype.render=function(){this.renderOptions_=this.createRenderOptions();var t=this.renderOptions_.size;this.canvas_={},this.size_=[t,t]},e.prototype.draw_=function(t,i,r){if(i.scale(r,r),i.translate(t.size/2,t.size/2),this.createPath_(i),this.fill_){var a=this.fill_.getColor();a===null&&(a=ot),i.fillStyle=tt(a),i.fill()}this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,i.setLineDash&&t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit,i.stroke())},e.prototype.createHitDetectionCanvas_=function(t){if(this.fill_){var i=this.fill_.getColor(),r=0;if(typeof i=="string"&&(i=er(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0){var a=mt(t.size,t.size);this.hitDetectionCanvas_=a.canvas,this.drawHitDetectionCanvas_(t,a)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))},e.prototype.createPath_=function(t){var i=this.points_,r=this.radius_;if(i===1/0)t.arc(0,0,r,0,2*Math.PI);else{var a=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(i*=2);for(var s=this.angle_-Math.PI/2,o=2*Math.PI/i,h=0;h<i;h++){var l=s+h*o,u=h%2===0?r:a;t.lineTo(u*Math.cos(l),u*Math.sin(l))}t.closePath()}},e.prototype.drawHitDetectionCanvas_=function(t,i){i.translate(t.size/2,t.size/2),this.createPath_(i),i.fillStyle=ot,i.fill(),this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit,i.stroke())},e}(or),ea=ta,ia=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ra=function(n){ia(e,n);function e(t){var i=this,r=t||{};return i=n.call(this,{points:1/0,fill:r.fill,radius:r.radius,stroke:r.stroke,scale:r.scale!==void 0?r.scale:1,rotation:r.rotation!==void 0?r.rotation:0,rotateWithView:r.rotateWithView!==void 0?r.rotateWithView:!1,displacement:r.displacement!==void 0?r.displacement:[0,0]})||this,i}return e.prototype.clone=function(){var t=this.getScale(),i=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return i.setOpacity(this.getOpacity()),i},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(ea),hr=ra,na=function(){function n(e){var t=e||{};this.color_=t.color!==void 0?t.color:null}return n.prototype.clone=function(){var e=this.getColor();return new n({color:Array.isArray(e)?e.slice():e||void 0})},n.prototype.getColor=function(){return this.color_},n.prototype.setColor=function(e){this.color_=e},n}(),lr=na,aa=function(){function n(e){var t=e||{};this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}return n.prototype.clone=function(){var e=this.getColor();return new n({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},n.prototype.getColor=function(){return this.color_},n.prototype.getLineCap=function(){return this.lineCap_},n.prototype.getLineDash=function(){return this.lineDash_},n.prototype.getLineDashOffset=function(){return this.lineDashOffset_},n.prototype.getLineJoin=function(){return this.lineJoin_},n.prototype.getMiterLimit=function(){return this.miterLimit_},n.prototype.getWidth=function(){return this.width_},n.prototype.setColor=function(e){this.color_=e},n.prototype.setLineCap=function(e){this.lineCap_=e},n.prototype.setLineDash=function(e){this.lineDash_=e},n.prototype.setLineDashOffset=function(e){this.lineDashOffset_=e},n.prototype.setLineJoin=function(e){this.lineJoin_=e},n.prototype.setMiterLimit=function(e){this.miterLimit_=e},n.prototype.setWidth=function(e){this.width_=e},n}(),sa=aa,ur=function(){function n(e){var t=e||{};this.geometry_=null,this.geometryFunction_=Pi,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}return n.prototype.clone=function(){var e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new n({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},n.prototype.getRenderer=function(){return this.renderer_},n.prototype.setRenderer=function(e){this.renderer_=e},n.prototype.setHitDetectionRenderer=function(e){this.hitDetectionRenderer_=e},n.prototype.getHitDetectionRenderer=function(){return this.hitDetectionRenderer_},n.prototype.getGeometry=function(){return this.geometry_},n.prototype.getGeometryFunction=function(){return this.geometryFunction_},n.prototype.getFill=function(){return this.fill_},n.prototype.setFill=function(e){this.fill_=e},n.prototype.getImage=function(){return this.image_},n.prototype.setImage=function(e){this.image_=e},n.prototype.getStroke=function(){return this.stroke_},n.prototype.setStroke=function(e){this.stroke_=e},n.prototype.getText=function(){return this.text_},n.prototype.setText=function(e){this.text_=e},n.prototype.getZIndex=function(){return this.zIndex_},n.prototype.setGeometry=function(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=Pi,this.geometry_=e},n.prototype.setZIndex=function(e){this.zIndex_=e},n}();function oa(n){var e;if(typeof n=="function")e=n;else{var t;if(Array.isArray(n))t=n;else{pt(typeof n.getZIndex=="function",41);var i=n;t=[i]}e=function(){return t}}return e}var He=null;function ha(n,e){if(!He){var t=new lr({color:"rgba(255,255,255,0.4)"}),i=new sa({color:"#3399CC",width:1.25});He=[new ur({image:new hr({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return He}function Pi(n){return n.getGeometry()}var la=ur,ua=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ki={RENDER_ORDER:"renderOrder"},fa=function(n){ua(e,n);function e(t){var i=this,r=t||{},a=$r({},r);return delete a.style,delete a.renderBuffer,delete a.updateWhileAnimating,delete a.updateWhileInteracting,i=n.call(this,a)||this,i.declutter_=r.declutter!==void 0?r.declutter:!1,i.renderBuffer_=r.renderBuffer!==void 0?r.renderBuffer:100,i.style_=null,i.styleFunction_=void 0,i.setStyle(r.style),i.updateWhileAnimating_=r.updateWhileAnimating!==void 0?r.updateWhileAnimating:!1,i.updateWhileInteracting_=r.updateWhileInteracting!==void 0?r.updateWhileInteracting:!1,i}return e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(t){return n.prototype.getFeatures.call(this,t)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(ki.RENDER_ORDER)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.renderDeclutter=function(t){t.declutterTree||(t.declutterTree=new sr(9)),this.getRenderer().renderDeclutter(t)},e.prototype.setRenderOrder=function(t){this.set(ki.RENDER_ORDER,t)},e.prototype.setStyle=function(t){this.style_=t!==void 0?t:ha,this.styleFunction_=t===null?void 0:oa(this.style_),this.changed()},e}(Hr),ca=fa,Kt={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},de=[Kt.FILL],dt=[Kt.STROKE],gt=[Kt.BEGIN_PATH],Bi=[Kt.CLOSE_PATH],E=Kt,da=function(){function n(){}return n.prototype.drawCustom=function(e,t,i,r){},n.prototype.drawGeometry=function(e){},n.prototype.setStyle=function(e){},n.prototype.drawCircle=function(e,t){},n.prototype.drawFeature=function(e,t){},n.prototype.drawGeometryCollection=function(e,t){},n.prototype.drawLineString=function(e,t){},n.prototype.drawMultiLineString=function(e,t){},n.prototype.drawMultiPoint=function(e,t){},n.prototype.drawMultiPolygon=function(e,t){},n.prototype.drawPoint=function(e,t){},n.prototype.drawPolygon=function(e,t){},n.prototype.drawText=function(e,t){},n.prototype.setFillStrokeStyle=function(e,t){},n.prototype.setImageStyle=function(e,t){},n.prototype.setTextStyle=function(e,t){},n}(),fr=da,pa=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),_a=function(n){pa(e,n);function e(t,i,r,a){var s=n.call(this)||this;return s.tolerance=t,s.maxExtent=i,s.pixelRatio=a,s.maxLineWidth=0,s.resolution=r,s.beginGeometryInstruction1_=null,s.beginGeometryInstruction2_=null,s.bufferedMaxExtent_=null,s.instructions=[],s.coordinates=[],s.tmpCoordinate_=[],s.hitDetectionInstructions=[],s.state={},s}return e.prototype.applyPixelRatio=function(t){var i=this.pixelRatio;return i==1?t:t.map(function(r){return r*i})},e.prototype.appendFlatPointCoordinates=function(t,i){for(var r=this.getBufferedMaxExtent(),a=this.tmpCoordinate_,s=this.coordinates,o=s.length,h=0,l=t.length;h<l;h+=i)a[0]=t[h],a[1]=t[h+1],Vr(r,a)&&(s[o++]=a[0],s[o++]=a[1]);return o},e.prototype.appendFlatLineCoordinates=function(t,i,r,a,s,o){var h=this.coordinates,l=h.length,u=this.getBufferedMaxExtent();o&&(i+=a);var f=t[i],c=t[i+1],d=this.tmpCoordinate_,p=!0,_,v,g;for(_=i+a;_<r;_+=a)d[0]=t[_],d[1]=t[_+1],g=jr(u,d),g!==v?(p&&(h[l++]=f,h[l++]=c,p=!1),h[l++]=d[0],h[l++]=d[1]):g===zr.INTERSECTING?(h[l++]=d[0],h[l++]=d[1],p=!1):p=!0,f=d[0],c=d[1],v=g;return(s&&p||_===i+a)&&(h[l++]=f,h[l++]=c),l},e.prototype.drawCustomCoordinates_=function(t,i,r,a,s){for(var o=0,h=r.length;o<h;++o){var l=r[o],u=this.appendFlatLineCoordinates(t,i,l,a,!1,!1);s.push(u),i=l}return i},e.prototype.drawCustom=function(t,i,r,a){this.beginGeometry(t,i);var s=t.getType(),o=t.getStride(),h=this.coordinates.length,l,u,f,c,d;switch(s){case R.MULTI_POLYGON:l=t.getOrientedFlatCoordinates(),c=[];var p=t.getEndss();d=0;for(var _=0,v=p.length;_<v;++_){var g=[];d=this.drawCustomCoordinates_(l,d,p[_],o,g),c.push(g)}this.instructions.push([E.CUSTOM,h,c,t,r,Ri]),this.hitDetectionInstructions.push([E.CUSTOM,h,c,t,a||r,Ri]);break;case R.POLYGON:case R.MULTI_LINE_STRING:f=[],l=s==R.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(l,0,t.getEnds(),o,f),this.instructions.push([E.CUSTOM,h,f,t,r,Oi]),this.hitDetectionInstructions.push([E.CUSTOM,h,f,t,a||r,Oi]);break;case R.LINE_STRING:case R.CIRCLE:l=t.getFlatCoordinates(),u=this.appendFlatLineCoordinates(l,0,l.length,o,!1,!1),this.instructions.push([E.CUSTOM,h,u,t,r,he]),this.hitDetectionInstructions.push([E.CUSTOM,h,u,t,a||r,he]);break;case R.MULTI_POINT:l=t.getFlatCoordinates(),u=this.appendFlatPointCoordinates(l,o),u>h&&(this.instructions.push([E.CUSTOM,h,u,t,r,he]),this.hitDetectionInstructions.push([E.CUSTOM,h,u,t,a||r,he]));break;case R.POINT:l=t.getFlatCoordinates(),this.coordinates.push(l[0],l[1]),u=this.coordinates.length,this.instructions.push([E.CUSTOM,h,u,t,r]),this.hitDetectionInstructions.push([E.CUSTOM,h,u,t,a||r]);break}this.endGeometry(i)},e.prototype.beginGeometry=function(t,i){this.beginGeometryInstruction1_=[E.BEGIN_GEOMETRY,i,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[E.BEGIN_GEOMETRY,i,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t=this.hitDetectionInstructions;t.reverse();var i,r=t.length,a,s,o=-1;for(i=0;i<r;++i)a=t[i],s=a[0],s==E.END_GEOMETRY?o=i:s==E.BEGIN_GEOMETRY&&(a[2]=i,Jr(this.hitDetectionInstructions,o,i),o=-1)},e.prototype.setFillStrokeStyle=function(t,i){var r=this.state;if(t){var a=t.getColor();r.fillStyle=tt(a||ot)}else r.fillStyle=void 0;if(i){var s=i.getColor();r.strokeStyle=tt(s||Ht);var o=i.getLineCap();r.lineCap=o!==void 0?o:me;var h=i.getLineDash();r.lineDash=h?h.slice():zt;var l=i.getLineDashOffset();r.lineDashOffset=l||Jt;var u=i.getLineJoin();r.lineJoin=u!==void 0?u:Ot;var f=i.getWidth();r.lineWidth=f!==void 0?f:Vt;var c=i.getMiterLimit();r.miterLimit=c!==void 0?c:jt,r.lineWidth>this.maxLineWidth&&(this.maxLineWidth=r.lineWidth,this.bufferedMaxExtent_=null)}else r.strokeStyle=void 0,r.lineCap=void 0,r.lineDash=null,r.lineDashOffset=void 0,r.lineJoin=void 0,r.lineWidth=void 0,r.miterLimit=void 0},e.prototype.createFill=function(t){var i=t.fillStyle,r=[E.SET_FILL_STYLE,i];return typeof i!="string"&&r.push(!0),r},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[E.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,i){var r=t.fillStyle;(typeof r!="string"||t.currentFillStyle!=r)&&(r!==void 0&&this.instructions.push(i.call(this,t)),t.currentFillStyle=r)},e.prototype.updateStrokeStyle=function(t,i){var r=t.strokeStyle,a=t.lineCap,s=t.lineDash,o=t.lineDashOffset,h=t.lineJoin,l=t.lineWidth,u=t.miterLimit;(t.currentStrokeStyle!=r||t.currentLineCap!=a||s!=t.currentLineDash&&!Ce(t.currentLineDash,s)||t.currentLineDashOffset!=o||t.currentLineJoin!=h||t.currentLineWidth!=l||t.currentMiterLimit!=u)&&(r!==void 0&&i.call(this,t),t.currentStrokeStyle=r,t.currentLineCap=a,t.currentLineDash=s,t.currentLineDashOffset=o,t.currentLineJoin=h,t.currentLineWidth=l,t.currentMiterLimit=u)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var i=[E.END_GEOMETRY,t];this.instructions.push(i),this.hitDetectionInstructions.push(i)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=qr(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;ai(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(fr),Zt=_a,va=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ga=function(n){va(e,n);function e(t,i,r,a){var s=n.call(this,t,i,r,a)||this;return s.hitDetectionImage_=null,s.image_=null,s.imagePixelRatio_=void 0,s.anchorX_=void 0,s.anchorY_=void 0,s.height_=void 0,s.opacity_=void 0,s.originX_=void 0,s.originY_=void 0,s.rotateWithView_=void 0,s.rotation_=void 0,s.scale_=void 0,s.width_=void 0,s.declutterImageWithText_=void 0,s}return e.prototype.drawPoint=function(t,i){if(!!this.image_){this.beginGeometry(t,i);var r=t.getFlatCoordinates(),a=t.getStride(),s=this.coordinates.length,o=this.appendFlatPointCoordinates(r,a);this.instructions.push([E.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([E.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(i)}},e.prototype.drawMultiPoint=function(t,i){if(!!this.image_){this.beginGeometry(t,i);var r=t.getFlatCoordinates(),a=t.getStride(),s=this.coordinates.length,o=this.appendFlatPointCoordinates(r,a);this.instructions.push([E.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([E.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(i)}},e.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,n.prototype.finish.call(this)},e.prototype.setImageStyle=function(t,i){var r=t.getAnchor(),a=t.getSize(),s=t.getHitDetectionImage(),o=t.getImage(this.pixelRatio),h=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=s,this.image_=o,this.height_=a[1],this.opacity_=t.getOpacity(),this.originX_=h[0]*this.imagePixelRatio_,this.originY_=h[1]*this.imagePixelRatio_,this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=a[0],this.declutterImageWithText_=i},e}(Zt),ma=ga,ya=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),xa=function(n){ya(e,n);function e(t,i,r,a){return n.call(this,t,i,r,a)||this}return e.prototype.drawFlatCoordinates_=function(t,i,r,a){var s=this.coordinates.length,o=this.appendFlatLineCoordinates(t,i,r,a,!1,!1),h=[E.MOVE_TO_LINE_TO,s,o];return this.instructions.push(h),this.hitDetectionInstructions.push(h),r},e.prototype.drawLineString=function(t,i){var r=this.state,a=r.strokeStyle,s=r.lineWidth;if(!(a===void 0||s===void 0)){this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,i),this.hitDetectionInstructions.push([E.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,zt,Jt],gt);var o=t.getFlatCoordinates(),h=t.getStride();this.drawFlatCoordinates_(o,0,o.length,h),this.hitDetectionInstructions.push(dt),this.endGeometry(i)}},e.prototype.drawMultiLineString=function(t,i){var r=this.state,a=r.strokeStyle,s=r.lineWidth;if(!(a===void 0||s===void 0)){this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,i),this.hitDetectionInstructions.push([E.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset],gt);for(var o=t.getEnds(),h=t.getFlatCoordinates(),l=t.getStride(),u=0,f=0,c=o.length;f<c;++f)u=this.drawFlatCoordinates_(h,u,o[f],l);this.hitDetectionInstructions.push(dt),this.endGeometry(i)}},e.prototype.finish=function(){var t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(dt),this.reverseHitDetectionInstructions(),this.state=null,n.prototype.finish.call(this)},e.prototype.applyStroke=function(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(dt),t.lastStroke=this.coordinates.length),t.lastStroke=0,n.prototype.applyStroke.call(this,t),this.instructions.push(gt)},e}(Zt),Sa=xa,Ia=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ea=function(n){Ia(e,n);function e(t,i,r,a){return n.call(this,t,i,r,a)||this}return e.prototype.drawFlatCoordinatess_=function(t,i,r,a){var s=this.state,o=s.fillStyle!==void 0,h=s.strokeStyle!==void 0,l=r.length;this.instructions.push(gt),this.hitDetectionInstructions.push(gt);for(var u=0;u<l;++u){var f=r[u],c=this.coordinates.length,d=this.appendFlatLineCoordinates(t,i,f,a,!0,!h),p=[E.MOVE_TO_LINE_TO,c,d];this.instructions.push(p),this.hitDetectionInstructions.push(p),h&&(this.instructions.push(Bi),this.hitDetectionInstructions.push(Bi)),i=f}return o&&(this.instructions.push(de),this.hitDetectionInstructions.push(de)),h&&(this.instructions.push(dt),this.hitDetectionInstructions.push(dt)),i},e.prototype.drawCircle=function(t,i){var r=this.state,a=r.fillStyle,s=r.strokeStyle;if(!(a===void 0&&s===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([E.SET_FILL_STYLE,ot]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([E.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);var o=t.getFlatCoordinates(),h=t.getStride(),l=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,h,!1,!1);var u=[E.CIRCLE,l];this.instructions.push(gt,u),this.hitDetectionInstructions.push(gt,u),r.fillStyle!==void 0&&(this.instructions.push(de),this.hitDetectionInstructions.push(de)),r.strokeStyle!==void 0&&(this.instructions.push(dt),this.hitDetectionInstructions.push(dt)),this.endGeometry(i)}},e.prototype.drawPolygon=function(t,i){var r=this.state,a=r.fillStyle,s=r.strokeStyle;if(!(a===void 0&&s===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([E.SET_FILL_STYLE,ot]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([E.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);var o=t.getEnds(),h=t.getOrientedFlatCoordinates(),l=t.getStride();this.drawFlatCoordinatess_(h,0,o,l),this.endGeometry(i)}},e.prototype.drawMultiPolygon=function(t,i){var r=this.state,a=r.fillStyle,s=r.strokeStyle;if(!(a===void 0&&s===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([E.SET_FILL_STYLE,ot]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([E.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);for(var o=t.getEndss(),h=t.getOrientedFlatCoordinates(),l=t.getStride(),u=0,f=0,c=o.length;f<c;++f)u=this.drawFlatCoordinatess_(h,u,o[f],l);this.endGeometry(i)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(t!==0)for(var i=this.coordinates,r=0,a=i.length;r<a;++r)i[r]=Kr(i[r],t);return n.prototype.finish.call(this)},e.prototype.setFillStrokeStyles_=function(){var t=this.state,i=t.fillStyle;i!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)},e}(Zt),Ni=Ea,Ta={POINT:"point",LINE:"line"};function Ca(n,e,t,i,r){var a=t,s=t,o=0,h=0,l=t,u,f,c,d,p,_,v,g,m,x;for(f=t;f<i;f+=r){var S=e[f],I=e[f+1];p!==void 0&&(m=S-p,x=I-_,d=Math.sqrt(m*m+x*x),v!==void 0&&(h+=c,u=Math.acos((v*m+g*x)/(c*d)),u>n&&(h>o&&(o=h,a=l,s=f),h=0,l=f-r)),c=d,v=m,g=x),p=S,_=I}return h+=d,h>o?[l,f]:[a,s]}var wa=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Te={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},Oa=function(n){wa(e,n);function e(t,i,r,a){var s=n.call(this,t,i,r,a)||this;return s.labels_=null,s.text_="",s.textOffsetX_=0,s.textOffsetY_=0,s.textRotateWithView_=void 0,s.textRotation_=0,s.textFillState_=null,s.fillStates={},s.textStrokeState_=null,s.strokeStates={},s.textState_={},s.textStates={},s.textKey_="",s.fillKey_="",s.strokeKey_="",s.declutterImageWithText_=void 0,s}return e.prototype.finish=function(){var t=n.prototype.finish.call(this);return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t},e.prototype.drawText=function(t,i){var r=this.textFillState_,a=this.textStrokeState_,s=this.textState_;if(!(this.text_===""||!s||!r&&!a)){var o=this.coordinates,h=o.length,l=t.getType(),u=null,f=t.getStride();if(s.placement===Ta.LINE&&(l==R.LINE_STRING||l==R.MULTI_LINE_STRING||l==R.POLYGON||l==R.MULTI_POLYGON)){if(!Z(this.getBufferedMaxExtent(),t.getExtent()))return;var c=void 0;if(u=t.getFlatCoordinates(),l==R.LINE_STRING)c=[u.length];else if(l==R.MULTI_LINE_STRING)c=t.getEnds();else if(l==R.POLYGON)c=t.getEnds().slice(0,1);else if(l==R.MULTI_POLYGON){var d=t.getEndss();c=[];for(var p=0,_=d.length;p<_;++p)c.push(d[p][0])}this.beginGeometry(t,i);for(var v=s.textAlign,g=0,m=void 0,x=0,S=c.length;x<S;++x){if(v==null){var I=Ca(s.maxAngle,u,g,c[x],f);g=I[0],m=I[1]}else m=c[x];for(var p=g;p<m;p+=f)o.push(u[p],u[p+1]);var C=o.length;g=c[x],this.drawChars_(h,C),h=C}this.endGeometry(i)}else{var O=s.overflow?null:[];switch(l){case R.POINT:case R.MULTI_POINT:u=t.getFlatCoordinates();break;case R.LINE_STRING:u=t.getFlatMidpoint();break;case R.CIRCLE:u=t.getCenter();break;case R.MULTI_LINE_STRING:u=t.getFlatMidpoints(),f=2;break;case R.POLYGON:u=t.getFlatInteriorPoint(),s.overflow||O.push(u[2]/this.resolution),f=3;break;case R.MULTI_POLYGON:var T=t.getFlatInteriorPoints();u=[];for(var p=0,_=T.length;p<_;p+=3)s.overflow||O.push(T[p+2]/this.resolution),u.push(T[p],T[p+1]);if(u.length===0)return;f=2;break}var C=this.appendFlatPointCoordinates(u,f);if(C===h)return;if(O&&(C-h)/2!==u.length/f){var w=h/2;O=O.filter(function(b,P){var N=o[(w+P)*2]===u[P*f]&&o[(w+P)*2+1]===u[P*f+1];return N||--w,N})}this.saveTextStates_(),(s.backgroundFill||s.backgroundStroke)&&(this.setFillStrokeStyle(s.backgroundFill,s.backgroundStroke),s.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),s.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,i);var F=s.padding;if(F!=vt&&(s.scale[0]<0||s.scale[1]<0)){var L=s.padding[0],D=s.padding[1],A=s.padding[2],B=s.padding[3];s.scale[0]<0&&(D=-D,B=-B),s.scale[1]<0&&(L=-L,A=-A),F=[L,D,A,B]}var U=this.pixelRatio;this.instructions.push([E.DRAW_IMAGE,h,C,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterImageWithText_,F==vt?vt:F.map(function(b){return b*U}),!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,O]);var G=1/U;this.hitDetectionInstructions.push([E.DRAW_IMAGE,h,C,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[G,G],NaN,this.declutterImageWithText_,F,!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,O]),this.endGeometry(i)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,i=this.textState_,r=this.textFillState_,a=this.strokeKey_;t&&(a in this.strokeStates||(this.strokeStates[a]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var s=this.textKey_;s in this.textStates||(this.textStates[s]={font:i.font,textAlign:i.textAlign||qt,textBaseline:i.textBaseline||ye,scale:i.scale});var o=this.fillKey_;r&&(o in this.fillStates||(this.fillStates[o]={fillStyle:r.fillStyle}))},e.prototype.drawChars_=function(t,i){var r=this.textStrokeState_,a=this.textState_,s=this.strokeKey_,o=this.textKey_,h=this.fillKey_;this.saveTextStates_();var l=this.pixelRatio,u=Te[a.textBaseline],f=this.textOffsetY_*l,c=this.text_,d=r?r.lineWidth*Math.abs(a.scale[0])/2:0;this.instructions.push([E.DRAW_CHARS,t,i,u,a.overflow,h,a.maxAngle,l,f,s,d*l,c,o,1]),this.hitDetectionInstructions.push([E.DRAW_CHARS,t,i,u,a.overflow,h,a.maxAngle,1,f,s,d,c,o,1/l])},e.prototype.setTextStyle=function(t,i){var r,a,s;if(!t)this.text_="";else{var o=t.getFill();o?(a=this.textFillState_,a||(a={},this.textFillState_=a),a.fillStyle=tt(o.getColor()||ot)):(a=null,this.textFillState_=a);var h=t.getStroke();if(!h)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);var l=h.getLineDash(),u=h.getLineDashOffset(),f=h.getWidth(),c=h.getMiterLimit();s.lineCap=h.getLineCap()||me,s.lineDash=l?l.slice():zt,s.lineDashOffset=u===void 0?Jt:u,s.lineJoin=h.getLineJoin()||Ot,s.lineWidth=f===void 0?Vt:f,s.miterLimit=c===void 0?jt:c,s.strokeStyle=tt(h.getColor()||Ht)}r=this.textState_;var d=t.getFont()||ir;Zr(d);var p=t.getScaleArray();r.overflow=t.getOverflow(),r.font=d,r.maxAngle=t.getMaxAngle(),r.placement=t.getPlacement(),r.textAlign=t.getTextAlign(),r.textBaseline=t.getTextBaseline()||ye,r.backgroundFill=t.getBackgroundFill(),r.backgroundStroke=t.getBackgroundStroke(),r.padding=t.getPadding()||vt,r.scale=p===void 0?[1,1]:p;var _=t.getOffsetX(),v=t.getOffsetY(),g=t.getRotateWithView(),m=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=_===void 0?0:_,this.textOffsetY_=v===void 0?0:v,this.textRotateWithView_=g===void 0?!1:g,this.textRotation_=m===void 0?0:m,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:X(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.textBaseline||"?"),this.fillKey_=a?typeof a.fillStyle=="string"?a.fillStyle:"|"+X(a.fillStyle):""}this.declutterImageWithText_=i},e}(Zt),Ra=Oa,La={Circle:Ni,Default:Zt,Image:ma,LineString:Sa,Polygon:Ni,Text:Ra},Da=function(){function n(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}return n.prototype.finish=function(){var e={};for(var t in this.buildersByZIndex_){e[t]=e[t]||{};var i=this.buildersByZIndex_[t];for(var r in i){var a=i[r].finish();e[t][r]=a}}return e},n.prototype.getBuilder=function(e,t){var i=e!==void 0?e.toString():"0",r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);var a=r[t];if(a===void 0){var s=La[t];a=new s(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=a}return a},n}(),bi=Da,k={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};function Fa(n,e,t,i,r,a,s,o,h,l,u,f){var c=n[e],d=n[e+1],p=0,_=0,v=0,g=0;function m(){p=c,_=d,e+=i,c=n[e],d=n[e+1],g+=v,v=Math.sqrt((c-p)*(c-p)+(d-_)*(d-_))}do m();while(e<t-i&&g+v<a);for(var x=v===0?0:(a-g)/v,S=yt(p,c,x),I=yt(_,d,x),C=e-i,O=g,T=a+o*h(l,r,u);e<t-i&&g+v<T;)m();x=v===0?0:(T-g)/v;var w=yt(p,c,x),F=yt(_,d,x),L;if(f){var D=[S,I,w,F];Qr(D,0,4,2,f,D,D),L=D[0]>D[2]}else L=S>w;var A=Math.PI,B=[],U=C+i===e;e=C,v=0,g=O,c=n[e],d=n[e+1];var G;if(U){m(),G=Math.atan2(d-_,c-p),L&&(G+=G>0?-A:A);var M=(w+S)/2,b=(F+I)/2;return B[0]=[M,b,(T-a)/2,G,r],B}for(var P=0,N=r.length;P<N;){m();var Y=Math.atan2(d-_,c-p);if(L&&(Y+=Y>0?-A:A),G!==void 0){var y=Y-G;if(y+=y>A?-2*A:y<-A?2*A:0,Math.abs(y)>s)return null}G=Y;for(var it=P,rt=0;P<N;++P){var Lt=L?N-P-1:P,te=o*h(l,r[Lt],u);if(e+i<t&&g+v<a+rt+te/2)break;rt+=te}if(P!==it){var Fe=L?r.substring(N-it,N-P):r.substring(it,P);x=v===0?0:(a+rt/2-g)/v;var M=yt(p,c,x),b=yt(_,d,x);B.push([M,b,rt/2,Y,Fe]),a+=rt}}return B}var It=Ie(),lt=[],at=[],st=[],ut=[];function Gi(n){return n[3].declutterBox}var Aa=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function Yi(n,e){return(e==="start"||e==="end")&&!Aa.test(n)&&(e=e==="start"?"left":"right"),Te[e]}var Ma=function(){function n(e,t,i,r){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=xe(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={}}return n.prototype.createLabel=function(e,t,i,r){var a=e+t+i+r;if(this.labels_[a])return this.labels_[a];var s=r?this.strokeStates[r]:null,o=i?this.fillStates[i]:null,h=this.textStates[t],l=this.pixelRatio,u=[h.scale[0]*l,h.scale[1]*l],f=Yi(e,h.textAlign||qt),c=r&&s.lineWidth?s.lineWidth:0,d=e.split(`
`),p=d.length,_=[],v=tn(h.font,d,_),g=en(h.font),m=g*p,x=v+c,S=[],I=(x+2)*u[0],C=(m+c)*u[1],O={width:I<0?Math.floor(I):Math.ceil(I),height:C<0?Math.floor(C):Math.ceil(C),contextInstructions:S};if((u[0]!=1||u[1]!=1)&&S.push("scale",u),S.push("font",h.font),r){S.push("strokeStyle",s.strokeStyle),S.push("lineWidth",c),S.push("lineCap",s.lineCap),S.push("lineJoin",s.lineJoin),S.push("miterLimit",s.miterLimit);var T=rn?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D;T.prototype.setLineDash&&(S.push("setLineDash",[s.lineDash]),S.push("lineDashOffset",s.lineDashOffset))}i&&S.push("fillStyle",o.fillStyle),S.push("textBaseline","middle"),S.push("textAlign","center");var w=.5-f,F=f*x+w*c,L;if(r)for(L=0;L<p;++L)S.push("strokeText",[d[L],F+w*_[L],.5*(c+g)+L*g]);if(i)for(L=0;L<p;++L)S.push("fillText",[d[L],F+w*_[L],.5*(c+g)+L*g]);return this.labels_[a]=O,O},n.prototype.replayTextBackground_=function(e,t,i,r,a,s,o){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,a),e.lineTo.apply(e,t),s&&(this.alignFill_=s[2],this.fill_(e)),o&&(this.setStrokeStyle_(e,o),e.stroke())},n.prototype.calculateImageOrLabelDimensions_=function(e,t,i,r,a,s,o,h,l,u,f,c,d,p,_,v){o*=c[0],h*=c[1];var g=i-o,m=r-h,x=a+l>e?e-l:a,S=s+u>t?t-u:s,I=p[3]+x*c[0]+p[1],C=p[0]+S*c[1]+p[2],O=g-p[3],T=m-p[0];(_||f!==0)&&(lt[0]=O,ut[0]=O,lt[1]=T,at[1]=T,at[0]=O+I,st[0]=at[0],st[1]=T+C,ut[1]=st[1]);var w;return f!==0?(w=Se(xe(),i,r,1,1,f,-i,-r),Ct(w,lt),Ct(w,at),Ct(w,st),Ct(w,ut),ti(Math.min(lt[0],at[0],st[0],ut[0]),Math.min(lt[1],at[1],st[1],ut[1]),Math.max(lt[0],at[0],st[0],ut[0]),Math.max(lt[1],at[1],st[1],ut[1]),It)):ti(Math.min(O,O+I),Math.min(T,T+C),Math.max(O,O+I),Math.max(T,T+C),It),d&&(g=Math.round(g),m=Math.round(m)),{drawImageX:g,drawImageY:m,drawImageW:x,drawImageH:S,originX:l,originY:u,declutterBox:{minX:It[0],minY:It[1],maxX:It[2],maxY:It[3],value:v},canvasTransform:w,scale:c}},n.prototype.replayImageOrLabel_=function(e,t,i,r,a,s,o){var h=!!(s||o),l=r.declutterBox,u=e.canvas,f=o?o[2]*r.scale[0]/2:0,c=l.minX-f<=u.width/t&&l.maxX+f>=0&&l.minY-f<=u.height/t&&l.maxY+f>=0;return c&&(h&&this.replayTextBackground_(e,lt,at,st,ut,s,o),nn(e,r.canvasTransform,a,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0},n.prototype.fill_=function(e){if(this.alignFill_){var t=Ct(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(t[0]%i,t[1]%i),e.rotate(this.viewRotation_)}e.fill(),this.alignFill_&&e.restore()},n.prototype.setStrokeStyle_=function(e,t){e.strokeStyle=t[1],e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.setLineDash&&(e.lineDashOffset=t[7],e.setLineDash(t[6]))},n.prototype.drawLabelWithPointPlacement_=function(e,t,i,r){var a=this.textStates[t],s=this.createLabel(e,t,r,i),o=this.strokeStates[i],h=this.pixelRatio,l=Yi(e,a.textAlign||qt),u=Te[a.textBaseline||ye],f=o&&o.lineWidth?o.lineWidth:0,c=s.width/h-2*a.scale[0],d=l*c+2*(.5-l)*f,p=u*s.height/h+2*(.5-u)*f;return{label:s,anchorX:d,anchorY:p}},n.prototype.execute_=function(e,t,i,r,a,s,o,h){var l;this.pixelCoordinates_&&Ce(i,this.renderedTransform_)?l=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),l=Ut(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),an(this.renderedTransform_,i));for(var u=0,f=r.length,c=0,d,p,_,v,g,m,x,S,I,C,O,T,w=0,F=0,L=null,D=null,A=this.coordinateCache_,B=this.viewRotation_,U=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,G={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:B},M=this.instructions!=r||this.overlaps?0:200,b,P,N,Y;u<f;){var y=r[u],it=y[0];switch(it){case E.BEGIN_GEOMETRY:b=y[1],Y=y[3],b.getGeometry()?o!==void 0&&!Z(o,Y.getExtent())?u=y[2]+1:++u:u=y[2];break;case E.BEGIN_PATH:w>M&&(this.fill_(e),w=0),F>M&&(e.stroke(),F=0),!w&&!F&&(e.beginPath(),v=NaN,g=NaN),++u;break;case E.CIRCLE:c=y[1];var rt=l[c],Lt=l[c+1],te=l[c+2],Fe=l[c+3],ci=te-rt,di=Fe-Lt,pi=Math.sqrt(ci*ci+di*di);e.moveTo(rt+pi,Lt),e.arc(rt,Lt,pi,0,2*Math.PI,!0),++u;break;case E.CLOSE_PATH:e.closePath(),++u;break;case E.CUSTOM:c=y[1],d=y[2];var Rr=y[3],Lr=y[4],_i=y.length==6?y[5]:void 0;G.geometry=Rr,G.feature=b,u in A||(A[u]=[]);var Dt=A[u];_i?_i(l,c,d,2,Dt):(Dt[0]=l[c],Dt[1]=l[c+1],Dt.length=2),Lr(Dt,G),++u;break;case E.DRAW_IMAGE:c=y[1],d=y[2],S=y[3],p=y[4],_=y[5];var Ae=y[6],Dr=y[7],Fr=y[8],Ar=y[9],vi=y[10],Me=y[11],Mr=y[12],ee=y[13],Ft=y[14];if(!S&&y.length>=19){I=y[18],C=y[19],O=y[20],T=y[21];var Pe=this.drawLabelWithPointPlacement_(I,C,O,T);S=Pe.label,y[3]=S;var Pr=y[22];p=(Pe.anchorX-Pr)*this.pixelRatio,y[4]=p;var kr=y[23];_=(Pe.anchorY-kr)*this.pixelRatio,y[5]=_,Ae=S.height,y[6]=Ae,ee=S.width,y[13]=ee}var ke=void 0;y.length>24&&(ke=y[24]);var Be=void 0,ie=void 0,re=void 0;y.length>16?(Be=y[15],ie=y[16],re=y[17]):(Be=vt,ie=!1,re=!1),vi&&U?Me+=B:!vi&&!U&&(Me-=B);for(var Br=0;c<d;c+=2)if(!(ke&&ke[Br++]<ee/this.pixelRatio)){var nt=this.calculateImageOrLabelDimensions_(S.width,S.height,l[c],l[c+1],ee,Ae,p,_,Fr,Ar,Me,Mr,a,Be,ie||re,b),gi=[e,t,S,nt,Dr,ie?L:null,re?D:null],ne=void 0,Ne=void 0;if(h&&Ft){var ae=d-c;if(!Ft[ae]){Ft[ae]=gi;continue}if(ne=Ft[ae],delete Ft[ae],Ne=Gi(ne),h.collides(Ne))continue}h&&h.collides(nt.declutterBox)||(ne&&(h&&h.insert(Ne),this.replayImageOrLabel_.apply(this,ne)),h&&h.insert(nt.declutterBox),this.replayImageOrLabel_.apply(this,gi))}++u;break;case E.DRAW_CHARS:var mi=y[1],yi=y[2],be=y[3],Nr=y[4];T=y[5];var br=y[6],xi=y[7],Si=y[8];O=y[9];var Ge=y[10];I=y[11],C=y[12];var Ii=[y[13],y[13]],Ye=this.textStates[C],At=Ye.font,Mt=[Ye.scale[0]*xi,Ye.scale[1]*xi],Pt=void 0;At in this.widths_?Pt=this.widths_[At]:(Pt={},this.widths_[At]=Pt);var Ei=$n(l,mi,yi,2),Ti=Math.abs(Mt[0])*Li(At,I,Pt);if(Nr||Ti<=Ei){var Gr=this.textStates[C].textAlign,Yr=(Ei-Ti)*Te[Gr],kt=Fa(l,mi,yi,2,I,Yr,br,Math.abs(Mt[0]),Li,At,Pt,U?0:this.viewRotation_);t:if(kt){var Bt=[],ht=void 0,se=void 0,oe=void 0,$=void 0,z=void 0;if(O)for(ht=0,se=kt.length;ht<se;++ht){z=kt[ht],oe=z[4],$=this.createLabel(oe,C,"",O),p=z[2]+(Mt[0]<0?-Ge:Ge),_=be*$.height+(.5-be)*2*Ge*Mt[1]/Mt[0]-Si;var nt=this.calculateImageOrLabelDimensions_($.width,$.height,z[0],z[1],$.width,$.height,p,_,0,0,z[3],Ii,!1,vt,!1,b);if(h&&h.collides(nt.declutterBox))break t;Bt.push([e,t,$,nt,1,null,null])}if(T)for(ht=0,se=kt.length;ht<se;++ht){z=kt[ht],oe=z[4],$=this.createLabel(oe,C,T,""),p=z[2],_=be*$.height-Si;var nt=this.calculateImageOrLabelDimensions_($.width,$.height,z[0],z[1],$.width,$.height,p,_,0,0,z[3],Ii,!1,vt,!1,b);if(h&&h.collides(nt.declutterBox))break t;Bt.push([e,t,$,nt,1,null,null])}h&&h.load(Bt.map(Gi));for(var We=0,Wr=Bt.length;We<Wr;++We)this.replayImageOrLabel_.apply(this,Bt[We])}}++u;break;case E.END_GEOMETRY:if(s!==void 0){b=y[1];var Ci=s(b,Y);if(Ci)return Ci}++u;break;case E.FILL:M?w++:this.fill_(e),++u;break;case E.MOVE_TO_LINE_TO:for(c=y[1],d=y[2],P=l[c],N=l[c+1],m=P+.5|0,x=N+.5|0,(m!==v||x!==g)&&(e.moveTo(P,N),v=m,g=x),c+=2;c<d;c+=2)P=l[c],N=l[c+1],m=P+.5|0,x=N+.5|0,(c==d-2||m!==v||x!==g)&&(e.lineTo(P,N),v=m,g=x);++u;break;case E.SET_FILL_STYLE:L=y,this.alignFill_=y[2],w&&(this.fill_(e),w=0,F&&(e.stroke(),F=0)),e.fillStyle=y[1],++u;break;case E.SET_STROKE_STYLE:D=y,F&&(e.stroke(),F=0),this.setStrokeStyle_(e,y),++u;break;case E.STROKE:M?F++:e.stroke(),++u;break;default:++u;break}}w&&this.fill_(e),F&&e.stroke()},n.prototype.execute=function(e,t,i,r,a,s){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,a,void 0,void 0,s)},n.prototype.executeHitDetection=function(e,t,i,r,a){return this.viewRotation_=i,this.execute_(e,1,t,this.hitDetectionInstructions,!0,r,a)},n}(),Pa=Ma,Ve=[k.POLYGON,k.CIRCLE,k.LINE_STRING,k.IMAGE,k.TEXT,k.DEFAULT],ka=function(){function n(e,t,i,r,a,s){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=s,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=xe(),this.createExecutors_(a)}return n.prototype.clip=function(e,t){var i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()},n.prototype.createExecutors_=function(e){for(var t in e){var i=this.executorsByZIndex_[t];i===void 0&&(i={},this.executorsByZIndex_[t]=i);var r=e[t];for(var a in r){var s=r[a];i[a]=new Pa(this.resolution_,this.pixelRatio_,this.overlaps_,s)}}},n.prototype.hasExecutors=function(e){for(var t in this.executorsByZIndex_)for(var i=this.executorsByZIndex_[t],r=0,a=e.length;r<a;++r)if(e[r]in i)return!0;return!1},n.prototype.forEachFeatureAtCoordinate=function(e,t,i,r,a,s){r=Math.round(r);var o=r*2+1,h=Se(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),l=!this.hitDetectionContext_;l&&(this.hitDetectionContext_=mt(o,o));var u=this.hitDetectionContext_;u.canvas.width!==o||u.canvas.height!==o?(u.canvas.width=o,u.canvas.height=o):l||u.clearRect(0,0,o,o);var f;this.renderBuffer_!==void 0&&(f=Ie(),sn(f,e),ai(f,t*(this.renderBuffer_+r),f));var c=Ba(r),d;function p(C,O){for(var T=u.getImageData(0,0,o,o).data,w=0,F=c.length;w<F;w++)if(T[c[w]]>0){if(!s||d!==k.IMAGE&&d!==k.TEXT||s.indexOf(C)!==-1){var L=(c[w]-3)/4,D=r-L%o,A=r-(L/o|0),B=a(C,O,D*D+A*A);if(B)return B}u.clearRect(0,0,o,o);break}}var _=Object.keys(this.executorsByZIndex_).map(Number);_.sort(ei);var v,g,m,x,S;for(v=_.length-1;v>=0;--v){var I=_[v].toString();for(m=this.executorsByZIndex_[I],g=Ve.length-1;g>=0;--g)if(d=Ve[g],x=m[d],x!==void 0&&(S=x.executeHitDetection(u,h,i,p,f),S))return S}},n.prototype.getClipCoords=function(e){var t=this.maxExtent_;if(!t)return null;var i=t[0],r=t[1],a=t[2],s=t[3],o=[i,r,i,s,a,s,a,r];return Ut(o,0,8,2,e,o),o},n.prototype.isEmpty=function(){return Ee(this.executorsByZIndex_)},n.prototype.execute=function(e,t,i,r,a,s,o){var h=Object.keys(this.executorsByZIndex_).map(Number);h.sort(ei),this.maxExtent_&&(e.save(),this.clip(e,i));var l=s||Ve,u,f,c,d,p,_;for(o&&h.reverse(),u=0,f=h.length;u<f;++u){var v=h[u].toString();for(p=this.executorsByZIndex_[v],c=0,d=l.length;c<d;++c){var g=l[c];_=p[g],_!==void 0&&_.execute(e,t,i,r,a,o)}}this.maxExtent_&&e.restore()},n}(),je={};function Ba(n){if(je[n]!==void 0)return je[n];for(var e=n*2+1,t=n*n,i=new Array(t+1),r=0;r<=n;++r)for(var a=0;a<=n;++a){var s=r*r+a*a;if(s>t)break;var o=i[s];o||(o=[],i[s]=o),o.push(((n+r)*e+(n+a))*4+3),r>0&&o.push(((n-r)*e+(n+a))*4+3),a>0&&(o.push(((n+r)*e+(n-a))*4+3),r>0&&o.push(((n-r)*e+(n-a))*4+3))}for(var h=[],r=0,l=i.length;r<l;++r)i[r]&&h.push.apply(h,i[r]);return je[n]=h,h}var Wi=ka,Na=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ba=function(n){Na(e,n);function e(t,i,r,a,s,o,h){var l=n.call(this)||this;return l.context_=t,l.pixelRatio_=i,l.extent_=r,l.transform_=a,l.viewRotation_=s,l.squaredTolerance_=o,l.userTransform_=h,l.contextFillState_=null,l.contextStrokeState_=null,l.contextTextState_=null,l.fillState_=null,l.strokeState_=null,l.image_=null,l.imageAnchorX_=0,l.imageAnchorY_=0,l.imageHeight_=0,l.imageOpacity_=0,l.imageOriginX_=0,l.imageOriginY_=0,l.imageRotateWithView_=!1,l.imageRotation_=0,l.imageScale_=[0,0],l.imageWidth_=0,l.text_="",l.textOffsetX_=0,l.textOffsetY_=0,l.textRotateWithView_=!1,l.textRotation_=0,l.textScale_=[0,0],l.textFillState_=null,l.textStrokeState_=null,l.textState_=null,l.pixelCoordinates_=[],l.tmpLocalTransform_=xe(),l}return e.prototype.drawImages_=function(t,i,r,a){if(!!this.image_){var s=Ut(t,i,r,a,this.transform_,this.pixelCoordinates_),o=this.context_,h=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);var u=this.imageRotation_;this.imageRotateWithView_&&(u+=this.viewRotation_);for(var f=0,c=s.length;f<c;f+=2){var d=s[f]-this.imageAnchorX_,p=s[f+1]-this.imageAnchorY_;if(u!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){var _=d+this.imageAnchorX_,v=p+this.imageAnchorY_;Se(h,_,v,1,1,u,-_,-v),o.setTransform.apply(o,h),o.translate(_,v),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.setTransform(1,0,0,1,0,0)}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,p,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}},e.prototype.drawText_=function(t,i,r,a){if(!(!this.textState_||this.text_==="")){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var s=Ut(t,i,r,a,this.transform_,this.pixelCoordinates_),o=this.context_,h=this.textRotation_;for(this.textRotateWithView_&&(h+=this.viewRotation_);i<r;i+=a){var l=s[i]+this.textOffsetX_,u=s[i+1]+this.textOffsetY_;if(h!==0||this.textScale_[0]!=1||this.textScale_[1]!=1){var f=Se(this.tmpLocalTransform_,l,u,1,1,h,-l,-u);o.setTransform.apply(o,f),o.translate(l,u),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.setTransform(1,0,0,1,0,0)}else this.textStrokeState_&&o.strokeText(this.text_,l,u),this.textFillState_&&o.fillText(this.text_,l,u)}}},e.prototype.moveToLineTo_=function(t,i,r,a,s){var o=this.context_,h=Ut(t,i,r,a,this.transform_,this.pixelCoordinates_);o.moveTo(h[0],h[1]);var l=h.length;s&&(l-=2);for(var u=2;u<l;u+=2)o.lineTo(h[u],h[u+1]);return s&&o.closePath(),r},e.prototype.drawRings_=function(t,i,r,a){for(var s=0,o=r.length;s<o;++s)i=this.moveToLineTo_(t,i,r[s],a,!0);return i},e.prototype.drawCircle=function(t){if(!!Z(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var i=on(t,this.transform_,this.pixelCoordinates_),r=i[2]-i[0],a=i[3]-i[1],s=Math.sqrt(r*r+a*a),o=this.context_;o.beginPath(),o.arc(i[0],i[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.setTransform=function(t){this.transform_=t},e.prototype.drawGeometry=function(t){var i=t.getType();switch(i){case R.POINT:this.drawPoint(t);break;case R.LINE_STRING:this.drawLineString(t);break;case R.POLYGON:this.drawPolygon(t);break;case R.MULTI_POINT:this.drawMultiPoint(t);break;case R.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case R.MULTI_POLYGON:this.drawMultiPolygon(t);break;case R.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case R.CIRCLE:this.drawCircle(t);break}},e.prototype.drawFeature=function(t,i){var r=i.getGeometryFunction()(t);!r||!Z(this.extent_,r.getExtent())||(this.setStyle(i),this.drawGeometry(r))},e.prototype.drawGeometryCollection=function(t){for(var i=t.getGeometriesArray(),r=0,a=i.length;r<a;++r)this.drawGeometry(i[r])},e.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var i=t.getFlatCoordinates(),r=t.getStride();this.image_&&this.drawImages_(i,0,i.length,r),this.text_!==""&&this.drawText_(i,0,i.length,r)},e.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var i=t.getFlatCoordinates(),r=t.getStride();this.image_&&this.drawImages_(i,0,i.length,r),this.text_!==""&&this.drawText_(i,0,i.length,r)},e.prototype.drawLineString=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Z(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,r=t.getFlatCoordinates();i.beginPath(),this.moveToLineTo_(r,0,r.length,t.getStride(),!1),i.stroke()}if(this.text_!==""){var a=t.getFlatMidpoint();this.drawText_(a,0,2,2)}}},e.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var i=t.getExtent();if(!!Z(this.extent_,i)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var r=this.context_,a=t.getFlatCoordinates(),s=0,o=t.getEnds(),h=t.getStride();r.beginPath();for(var l=0,u=o.length;l<u;++l)s=this.moveToLineTo_(a,s,o[l],h,!1);r.stroke()}if(this.text_!==""){var f=t.getFlatMidpoints();this.drawText_(f,0,f.length,2)}}},e.prototype.drawPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Z(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var i=this.context_;i.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&i.fill(),this.strokeState_&&i.stroke()}if(this.text_!==""){var r=t.getFlatInteriorPoint();this.drawText_(r,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Z(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var i=this.context_,r=t.getOrientedFlatCoordinates(),a=0,s=t.getEndss(),o=t.getStride();i.beginPath();for(var h=0,l=s.length;h<l;++h){var u=s[h];a=this.drawRings_(r,a,u,o)}this.fillState_&&i.fill(),this.strokeState_&&i.stroke()}if(this.text_!==""){var f=t.getFlatInteriorPoints();this.drawText_(f,0,f.length,2)}}},e.prototype.setContextFillState_=function(t){var i=this.context_,r=this.contextFillState_;r?r.fillStyle!=t.fillStyle&&(r.fillStyle=t.fillStyle,i.fillStyle=t.fillStyle):(i.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var i=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=t.lineCap&&(r.lineCap=t.lineCap,i.lineCap=t.lineCap),i.setLineDash&&(Ce(r.lineDash,t.lineDash)||i.setLineDash(r.lineDash=t.lineDash),r.lineDashOffset!=t.lineDashOffset&&(r.lineDashOffset=t.lineDashOffset,i.lineDashOffset=t.lineDashOffset)),r.lineJoin!=t.lineJoin&&(r.lineJoin=t.lineJoin,i.lineJoin=t.lineJoin),r.lineWidth!=t.lineWidth&&(r.lineWidth=t.lineWidth,i.lineWidth=t.lineWidth),r.miterLimit!=t.miterLimit&&(r.miterLimit=t.miterLimit,i.miterLimit=t.miterLimit),r.strokeStyle!=t.strokeStyle&&(r.strokeStyle=t.strokeStyle,i.strokeStyle=t.strokeStyle)):(i.lineCap=t.lineCap,i.setLineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineJoin=t.lineJoin,i.lineWidth=t.lineWidth,i.miterLimit=t.miterLimit,i.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var i=this.context_,r=this.contextTextState_,a=t.textAlign?t.textAlign:qt;r?(r.font!=t.font&&(r.font=t.font,i.font=t.font),r.textAlign!=a&&(r.textAlign=a,i.textAlign=a),r.textBaseline!=t.textBaseline&&(r.textBaseline=t.textBaseline,i.textBaseline=t.textBaseline)):(i.font=t.font,i.textAlign=a,i.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:a,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,i){var r=this;if(!t)this.fillState_=null;else{var a=t.getColor();this.fillState_={fillStyle:tt(a||ot)}}if(!i)this.strokeState_=null;else{var s=i.getColor(),o=i.getLineCap(),h=i.getLineDash(),l=i.getLineDashOffset(),u=i.getLineJoin(),f=i.getWidth(),c=i.getMiterLimit(),d=h||zt;this.strokeState_={lineCap:o!==void 0?o:me,lineDash:this.pixelRatio_===1?d:d.map(function(p){return p*r.pixelRatio_}),lineDashOffset:(l||Jt)*this.pixelRatio_,lineJoin:u!==void 0?u:Ot,lineWidth:(f!==void 0?f:Vt)*this.pixelRatio_,miterLimit:c!==void 0?c:jt,strokeStyle:tt(s||Ht)}}},e.prototype.setImageStyle=function(t){var i;if(!t||!(i=t.getSize())){this.image_=null;return}var r=t.getAnchor(),a=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*this.pixelRatio_,this.imageAnchorY_=r[1]*this.pixelRatio_,this.imageHeight_=i[1]*this.pixelRatio_,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=a[0],this.imageOriginY_=a[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScaleArray(),this.imageWidth_=i[0]*this.pixelRatio_},e.prototype.setTextStyle=function(t){if(!t)this.text_="";else{var i=t.getFill();if(!i)this.textFillState_=null;else{var r=i.getColor();this.textFillState_={fillStyle:tt(r||ot)}}var a=t.getStroke();if(!a)this.textStrokeState_=null;else{var s=a.getColor(),o=a.getLineCap(),h=a.getLineDash(),l=a.getLineDashOffset(),u=a.getLineJoin(),f=a.getWidth(),c=a.getMiterLimit();this.textStrokeState_={lineCap:o!==void 0?o:me,lineDash:h||zt,lineDashOffset:l||Jt,lineJoin:u!==void 0?u:Ot,lineWidth:f!==void 0?f:Vt,miterLimit:c!==void 0?c:jt,strokeStyle:tt(s||Ht)}}var d=t.getFont(),p=t.getOffsetX(),_=t.getOffsetY(),v=t.getRotateWithView(),g=t.getRotation(),m=t.getScaleArray(),x=t.getText(),S=t.getTextAlign(),I=t.getTextBaseline();this.textState_={font:d!==void 0?d:ir,textAlign:S!==void 0?S:qt,textBaseline:I!==void 0?I:ye},this.text_=x!==void 0?x:"",this.textOffsetX_=p!==void 0?this.pixelRatio_*p:0,this.textOffsetY_=_!==void 0?this.pixelRatio_*_:0,this.textRotateWithView_=v!==void 0?v:!1,this.textRotation_=g!==void 0?g:0,this.textScale_=[this.pixelRatio_*m[0],this.pixelRatio_*m[1]]}},e}(fr),Ga=ba,ct={FRACTION:"fraction",PIXELS:"pixels"},J={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},Ya=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Gt=null,Wa=function(n){Ya(e,n);function e(t,i,r,a,s,o){var h=n.call(this)||this;return h.hitDetectionImage_=null,h.image_=t||new Image,a!==null&&(h.image_.crossOrigin=a),h.canvas_={},h.color_=o,h.unlisten_=null,h.imageState_=s,h.size_=r,h.src_=i,h.tainted_,h}return e.prototype.isTainted_=function(){if(this.tainted_===void 0&&this.imageState_===H.LOADED){Gt||(Gt=mt(1,1)),Gt.drawImage(this.image_,0,0);try{Gt.getImageData(0,0,1,1),this.tainted_=!1}catch{Gt=null,this.tainted_=!0}}return this.tainted_===!0},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent($t.CHANGE)},e.prototype.handleImageError_=function(){this.imageState_=H.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=H.LOADED,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_},e.prototype.getPixelRatio=function(t){return this.replaceColor_(t),this.canvas_[t]?t:1},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(){if(!this.hitDetectionImage_)if(this.isTainted_()){var t=this.size_[0],i=this.size_[1],r=mt(t,i);r.fillRect(0,0,t,i),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==H.IDLE){this.imageState_=H.LOADING;try{this.image_.src=this.src_}catch{this.handleImageError_()}this.unlisten_=hn(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},e.prototype.replaceColor_=function(t){if(!(!this.color_||this.canvas_[t]||this.imageState_!==H.LOADED)){var i=document.createElement("canvas");this.canvas_[t]=i,i.width=Math.ceil(this.image_.width*t),i.height=Math.ceil(this.image_.height*t);var r=i.getContext("2d");if(r.scale(t,t),r.drawImage(this.image_,0,0),r.globalCompositeOperation="multiply",r.globalCompositeOperation==="multiply"||this.isTainted_())r.fillStyle=ln(this.color_),r.fillRect(0,0,i.width/t,i.height/t),r.globalCompositeOperation="destination-in",r.drawImage(this.image_,0,0);else{for(var a=r.getImageData(0,0,i.width,i.height),s=a.data,o=this.color_[0]/255,h=this.color_[1]/255,l=this.color_[2]/255,u=this.color_[3],f=0,c=s.length;f<c;f+=4)s[f]*=o,s[f+1]*=h,s[f+2]*=l,s[f+3]*=u;r.putImageData(a,0,0)}}},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(un);function Xa(n,e,t,i,r,a){var s=Di.get(e,i,a);return s||(s=new Wa(n,e,t,i,r,a),Di.set(e,i,a,s)),s}var Ua=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),$a=function(n){Ua(e,n);function e(t){var i=this,r=t||{},a=r.opacity!==void 0?r.opacity:1,s=r.rotation!==void 0?r.rotation:0,o=r.scale!==void 0?r.scale:1,h=r.rotateWithView!==void 0?r.rotateWithView:!1;i=n.call(this,{opacity:a,rotation:s,scale:o,displacement:r.displacement!==void 0?r.displacement:[0,0],rotateWithView:h})||this,i.anchor_=r.anchor!==void 0?r.anchor:[.5,.5],i.normalizedAnchor_=null,i.anchorOrigin_=r.anchorOrigin!==void 0?r.anchorOrigin:J.TOP_LEFT,i.anchorXUnits_=r.anchorXUnits!==void 0?r.anchorXUnits:ct.FRACTION,i.anchorYUnits_=r.anchorYUnits!==void 0?r.anchorYUnits:ct.FRACTION,i.crossOrigin_=r.crossOrigin!==void 0?r.crossOrigin:null;var l=r.img!==void 0?r.img:null,u=r.imgSize!==void 0?r.imgSize:null,f=r.src;pt(!(f!==void 0&&l),4),pt(!l||l&&u,5),(f===void 0||f.length===0)&&l&&(f=l.src||X(l)),pt(f!==void 0&&f.length>0,6);var c=r.src!==void 0?H.IDLE:H.LOADED;return i.color_=r.color!==void 0?er(r.color):null,i.iconImage_=Xa(l,f,u,i.crossOrigin_,c,i.color_),i.offset_=r.offset!==void 0?r.offset:[0,0],i.offsetOrigin_=r.offsetOrigin!==void 0?r.offsetOrigin:J.TOP_LEFT,i.origin_=null,i.size_=r.size!==void 0?r.size:null,i}return e.prototype.clone=function(){var t=this.getScale();return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:this.size_!==null?this.size_.slice():void 0,opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},e.prototype.getAnchor=function(){var t=this.normalizedAnchor_;if(!t){t=this.anchor_;var i=this.getSize();if(this.anchorXUnits_==ct.FRACTION||this.anchorYUnits_==ct.FRACTION){if(!i)return null;t=this.anchor_.slice(),this.anchorXUnits_==ct.FRACTION&&(t[0]*=i[0]),this.anchorYUnits_==ct.FRACTION&&(t[1]*=i[1])}if(this.anchorOrigin_!=J.TOP_LEFT){if(!i)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_==J.TOP_RIGHT||this.anchorOrigin_==J.BOTTOM_RIGHT)&&(t[0]=-t[0]+i[0]),(this.anchorOrigin_==J.BOTTOM_LEFT||this.anchorOrigin_==J.BOTTOM_RIGHT)&&(t[1]=-t[1]+i[1])}this.normalizedAnchor_=t}var r=this.getDisplacement();return[t[0]-r[0],t[1]+r[1]]},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getPixelRatio=function(t){return this.iconImage_.getPixelRatio(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(){return this.iconImage_.getHitDetectionImage()},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=J.TOP_LEFT){var i=this.getSize(),r=this.iconImage_.getSize();if(!i||!r)return null;t=t.slice(),(this.offsetOrigin_==J.TOP_RIGHT||this.offsetOrigin_==J.BOTTOM_RIGHT)&&(t[0]=r[0]-i[0]-t[0]),(this.offsetOrigin_==J.BOTTOM_LEFT||this.offsetOrigin_==J.BOTTOM_RIGHT)&&(t[1]=r[1]-i[1]-t[1])}return this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t){this.iconImage_.addEventListener($t.CHANGE,t)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener($t.CHANGE,t)},e}(or),Ha=$a,Q=.5;function Va(n,e,t,i,r,a,s){var o=n[0]*Q,h=n[1]*Q,l=mt(o,h);l.imageSmoothingEnabled=!1;for(var u=l.canvas,f=new Ga(l,Q,r,null,s),c=t.length,d=Math.floor((256*256*256-1)/c),p={},_=1;_<=c;++_){var v=t[_-1],g=v.getStyleFunction()||i;if(!!i){var m=g(v,a);if(!!m){Array.isArray(m)||(m=[m]);for(var x=_*d,S="#"+("000000"+x.toString(16)).slice(-6),I=0,C=m.length;I<C;++I){var O=m[I],T=O.getGeometryFunction()(v);if(!(!T||!Z(r,T.getExtent()))){var w=O.clone(),F=w.getFill();F&&F.setColor(S);var L=w.getStroke();L&&(L.setColor(S),L.setLineDash(null)),w.setText(void 0);var D=O.getImage();if(D&&D.getOpacity()!==0){var A=D.getImageSize();if(!A)continue;var B=mt(A[0],A[1],void 0,{alpha:!1}),U=B.canvas;B.fillStyle=S,B.fillRect(0,0,U.width,U.height),w.setImage(new Ha({img:U,imgSize:A,anchor:D.getAnchor(),anchorXUnits:ct.PIXELS,anchorYUnits:ct.PIXELS,offset:D.getOrigin(),opacity:1,size:D.getSize(),scale:D.getScale(),rotation:D.getRotation(),rotateWithView:D.getRotateWithView()}))}var G=w.getZIndex()||0,M=p[G];M||(M={},p[G]=M,M[R.POLYGON]=[],M[R.CIRCLE]=[],M[R.LINE_STRING]=[],M[R.POINT]=[]),M[T.getType().replace("Multi","")].push(T,w)}}}}}for(var b=Object.keys(p).map(Number).sort(ei),_=0,P=b.length;_<P;++_){var M=p[b[_]];for(var N in M)for(var Y=M[N],I=0,C=Y.length;I<C;I+=2){f.setStyle(Y[I+1]);for(var y=0,it=e.length;y<it;++y)f.setTransform(e[y]),f.drawGeometry(Y[I])}}return l.getImageData(0,0,u.width,u.height)}function ja(n,e,t){var i=[];if(t){var r=Math.floor(Math.round(n[0])*Q),a=Math.floor(Math.round(n[1])*Q),s=(Fi(r,0,t.width-1)+Fi(a,0,t.height-1)*t.width)*4,o=t.data[s],h=t.data[s+1],l=t.data[s+2],u=l+256*(h+256*o),f=Math.floor((256*256*256-1)/e.length);u&&u%f===0&&i.push(e[u/f-1])}return i}var za=.5,cr={Point:rs,LineString:ts,Polygon:as,MultiPoint:ns,MultiLineString:es,MultiPolygon:is,GeometryCollection:Qa,Circle:Ka};function Ja(n,e){return parseInt(X(n),10)-parseInt(X(e),10)}function qa(n,e){var t=ii(n,e);return t*t}function ii(n,e){return za*n/e}function Ka(n,e,t,i,r){var a=t.getFill(),s=t.getStroke();if(a||s){var o=n.getBuilder(t.getZIndex(),k.CIRCLE);o.setFillStrokeStyle(a,s),o.drawCircle(e,i)}var h=t.getText();if(h&&h.getText()){var l=(r||n).getBuilder(t.getZIndex(),k.TEXT);l.setTextStyle(h),l.drawText(e,i)}}function Xi(n,e,t,i,r,a,s){var o=!1,h=t.getImage();if(h){var l=h.getImageState();l==H.LOADED||l==H.ERROR?h.unlistenImageChange(r):(l==H.IDLE&&h.load(),l=h.getImageState(),h.listenImageChange(r),o=!0)}return Za(n,e,t,i,a,s),o}function Za(n,e,t,i,r,a){var s=t.getGeometryFunction()(e);if(!!s){var o=s.simplifyTransformed(i,r),h=t.getRenderer();if(h)dr(n,o,t,e);else{var l=cr[o.getType()];l(n,o,t,e,a)}}}function dr(n,e,t,i){if(e.getType()==R.GEOMETRY_COLLECTION){for(var r=e.getGeometries(),a=0,s=r.length;a<s;++a)dr(n,r[a],t,i);return}var o=n.getBuilder(t.getZIndex(),k.DEFAULT);o.drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer())}function Qa(n,e,t,i,r){var a=e.getGeometriesArray(),s,o;for(s=0,o=a.length;s<o;++s){var h=cr[a[s].getType()];h(n,a[s],t,i,r)}}function ts(n,e,t,i,r){var a=t.getStroke();if(a){var s=n.getBuilder(t.getZIndex(),k.LINE_STRING);s.setFillStrokeStyle(null,a),s.drawLineString(e,i)}var o=t.getText();if(o&&o.getText()){var h=(r||n).getBuilder(t.getZIndex(),k.TEXT);h.setTextStyle(o),h.drawText(e,i)}}function es(n,e,t,i,r){var a=t.getStroke();if(a){var s=n.getBuilder(t.getZIndex(),k.LINE_STRING);s.setFillStrokeStyle(null,a),s.drawMultiLineString(e,i)}var o=t.getText();if(o&&o.getText()){var h=(r||n).getBuilder(t.getZIndex(),k.TEXT);h.setTextStyle(o),h.drawText(e,i)}}function is(n,e,t,i,r){var a=t.getFill(),s=t.getStroke();if(s||a){var o=n.getBuilder(t.getZIndex(),k.POLYGON);o.setFillStrokeStyle(a,s),o.drawMultiPolygon(e,i)}var h=t.getText();if(h&&h.getText()){var l=(r||n).getBuilder(t.getZIndex(),k.TEXT);l.setTextStyle(h),l.drawText(e,i)}}function rs(n,e,t,i,r){var a=t.getImage(),s=t.getText(),o;if(r&&(n=r,o=a&&s&&s.getText()?{}:void 0),a){if(a.getImageState()!=H.LOADED)return;var h=n.getBuilder(t.getZIndex(),k.IMAGE);h.setImageStyle(a,o),h.drawPoint(e,i)}if(s&&s.getText()){var l=n.getBuilder(t.getZIndex(),k.TEXT);l.setTextStyle(s,o),l.drawText(e,i)}}function ns(n,e,t,i,r){var a=t.getImage(),s=t.getText(),o;if(r&&(n=r,o=a&&s&&s.getText()?{}:void 0),a){if(a.getImageState()!=H.LOADED)return;var h=n.getBuilder(t.getZIndex(),k.IMAGE);h.setImageStyle(a,o),h.drawMultiPoint(e,i)}if(s&&s.getText()){var l=(r||n).getBuilder(t.getZIndex(),k.TEXT);l.setTextStyle(s,o),l.drawText(e,i)}}function as(n,e,t,i,r){var a=t.getFill(),s=t.getStroke();if(a||s){var o=n.getBuilder(t.getZIndex(),k.POLYGON);o.setFillStrokeStyle(a,s),o.drawPolygon(e,i)}var h=t.getText();if(h&&h.getText()){var l=(r||n).getBuilder(t.getZIndex(),k.TEXT);l.setTextStyle(h),l.drawText(e,i)}}var ss=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),os=function(n){ss(e,n);function e(t){var i=n.call(this,t)||this;return i.boundHandleStyleImageChange_=i.handleStyleImageChange_.bind(i),i.animatingOrInteracting_,i.dirty_=!1,i.hitDetectionImageData_=null,i.renderedFeatures_=null,i.renderedRevision_=-1,i.renderedResolution_=NaN,i.renderedExtent_=Ie(),i.wrappedRenderedExtent_=Ie(),i.renderedRotation_,i.renderedCenter_=null,i.renderedProjection_=null,i.renderedRenderOrder_=null,i.replayGroup_=null,i.replayGroupChanged=!0,i.declutterExecutorGroup=null,i.clipping=!0,i}return e.prototype.renderWorlds=function(t,i,r){var a=i.extent,s=i.viewState,o=s.center,h=s.resolution,l=s.projection,u=s.rotation,f=l.getExtent(),c=this.getLayer().getSource(),d=i.pixelRatio,p=i.viewHints,_=!(p[le.ANIMATING]||p[le.INTERACTING]),v=this.context,g=Math.round(i.size[0]*d),m=Math.round(i.size[1]*d),x=c.getWrapX()&&l.canWrapX(),S=x?ue(f):null,I=x?Math.ceil((a[2]-f[2])/S)+1:1,C=x?Math.floor((a[0]-f[0])/S):0;do{var O=this.getRenderTransform(o,h,u,d,g,m,C*S);t.execute(v,1,O,u,_,void 0,r)}while(++C<I)},e.prototype.renderDeclutter=function(t){this.declutterExecutorGroup&&this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree)},e.prototype.renderFrame=function(t,i){var r=t.pixelRatio,a=t.layerStatesArray[t.layerIndex];fn(this.pixelTransform,1/r,1/r),cn(this.inversePixelTransform,this.pixelTransform);var s=dn(this.pixelTransform);this.useContainer(i,s,a.opacity,this.getBackground(t));var o=this.context,h=o.canvas,l=this.replayGroup_,u=this.declutterExecutorGroup;if((!l||l.isEmpty())&&(!u||u.isEmpty()))return null;var f=Math.round(t.size[0]*r),c=Math.round(t.size[1]*r);h.width!=f||h.height!=c?(h.width=f,h.height=c,h.style.transform!==s&&(h.style.transform=s)):this.containerReused||o.clearRect(0,0,f,c),this.preRender(o,t);var d=t.viewState;d.projection;var p=!1,_=!0;if(a.extent&&this.clipping){var v=pn(a.extent);_=Z(v,t.extent),p=_&&!Yt(v,t.extent),p&&this.clipUnrotated(o,t,v)}_&&this.renderWorlds(l,t),p&&o.restore(),this.postRender(o,t);var g=_n(a.opacity),m=this.container;return g!==m.style.opacity&&(m.style.opacity=g),this.renderedRotation_!==d.rotation&&(this.renderedRotation_=d.rotation,this.hitDetectionImageData_=null),this.container},e.prototype.getFeatures=function(t){return new Promise(function(i){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var r=[this.context.canvas.width,this.context.canvas.height];Ct(this.pixelTransform,r);var a=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,h=this.renderedProjection_,l=this.wrappedRenderedExtent_,u=this.getLayer(),f=[],c=r[0]*Q,d=r[1]*Q;f.push(this.getRenderTransform(a,s,o,Q,c,d,0).slice());var p=u.getSource(),_=h.getExtent();if(p.getWrapX()&&h.canWrapX()&&!Yt(_,l)){for(var v=l[0],g=ue(_),m=0,x=void 0;v<_[0];)--m,x=g*m,f.push(this.getRenderTransform(a,s,o,Q,c,d,x).slice()),v+=g;for(m=0,v=l[2];v>_[2];)++m,x=g*m,f.push(this.getRenderTransform(a,s,o,Q,c,d,x).slice()),v-=g}this.hitDetectionImageData_=Va(r,f,this.renderedFeatures_,u.getStyleFunction(),l,s,o)}i(ja(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},e.prototype.forEachFeatureAtCoordinate=function(t,i,r,a,s){var o=this;if(!!this.replayGroup_){var h=i.viewState.resolution,l=i.viewState.rotation,u=this.getLayer(),f={},c=function(_,v,g){var m=X(_),x=f[m];if(x){if(x!==!0&&g<x.distanceSq){if(g===0)return f[m]=!0,s.splice(s.lastIndexOf(x),1),a(_,u,v);x.geometry=v,x.distanceSq=g}}else{if(g===0)return f[m]=!0,a(_,u,v);s.push(f[m]={feature:_,layer:u,geometry:v,distanceSq:g,callback:a})}},d,p=[this.replayGroup_];return this.declutterExecutorGroup&&p.push(this.declutterExecutorGroup),p.some(function(_){return d=_.forEachFeatureAtCoordinate(t,h,l,r,c,_===o.declutterExecutorGroup&&i.declutterTree?i.declutterTree.all().map(function(v){return v.value}):null)}),d}},e.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t){var i=this.getLayer(),r=i.getSource();if(!r)return!1;var a=t.viewHints[le.ANIMATING],s=t.viewHints[le.INTERACTING],o=i.getUpdateWhileAnimating(),h=i.getUpdateWhileInteracting();if(!this.dirty_&&!o&&a||!h&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var l=t.extent,u=t.viewState,f=u.projection,c=u.resolution,d=t.pixelRatio,p=i.getRevision(),_=i.getRenderBuffer(),v=i.getRenderOrder();v===void 0&&(v=Ja);var g=u.center.slice(),m=ai(l,_*c),x=m.slice(),S=[m.slice()],I=f.getExtent();if(r.getWrapX()&&f.canWrapX()&&!Yt(I,t.extent)){var C=ue(I),O=Math.max(ue(m)/2,C);m[0]=I[0]-O,m[2]=I[2]+O,vn(g,f);var T=gn(S[0],f);T[0]<I[0]&&T[2]<I[2]?S.push([T[0]+C,T[1],T[2]+C,T[3]]):T[0]>I[0]&&T[2]>I[2]&&S.push([T[0]-C,T[1],T[2]-C,T[3]])}if(!this.dirty_&&this.renderedResolution_==c&&this.renderedRevision_==p&&this.renderedRenderOrder_==v&&Yt(this.wrappedRenderedExtent_,m))return Ce(this.renderedExtent_,x)||(this.hitDetectionImageData_=null,this.renderedExtent_=x),this.renderedCenter_=g,this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var w=new bi(ii(c,d),m,c,d),F;this.getLayer().getDeclutter()&&(F=new bi(ii(c,d),m,c,d));for(var L,D,A,D=0,A=S.length;D<A;++D)r.loadFeatures(S[D],c,f);var B=qa(c,d),U=function(N){var Y,y=N.getStyleFunction()||i.getStyleFunction();if(y&&(Y=y(N,c)),Y){var it=this.renderFeature(N,B,Y,w,L,F);this.dirty_=this.dirty_||it}}.bind(this),G=yn(m),M=r.getFeaturesInExtent(G);v&&M.sort(v);for(var D=0,A=M.length;D<A;++D)U(M[D]);this.renderedFeatures_=M;var b=w.finish(),P=new Wi(m,c,d,r.getOverlaps(),b,i.getRenderBuffer());return F&&(this.declutterExecutorGroup=new Wi(m,c,d,r.getOverlaps(),F.finish(),i.getRenderBuffer())),this.renderedResolution_=c,this.renderedRevision_=p,this.renderedRenderOrder_=v,this.renderedExtent_=x,this.wrappedRenderedExtent_=m,this.renderedCenter_=g,this.renderedProjection_=f,this.replayGroup_=P,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,i,r,a,s,o){if(!r)return!1;var h=!1;if(Array.isArray(r))for(var l=0,u=r.length;l<u;++l)h=Xi(a,t,r[l],i,this.boundHandleStyleImageChange_,s,o)||h;else h=Xi(a,t,r,i,this.boundHandleStyleImageChange_,s,o);return h},e}(mn),hs=os,ls=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),us=function(n){ls(e,n);function e(t){return n.call(this,t)||this}return e.prototype.createRenderer=function(){return new hs(this)},e}(ca),fs=us,cs=function(){function n(e){this.rbush_=new sr(e),this.items_={}}return n.prototype.insert=function(e,t){var i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[X(t)]=i},n.prototype.load=function(e,t){for(var i=new Array(t.length),r=0,a=t.length;r<a;r++){var s=e[r],o=t[r],h={minX:s[0],minY:s[1],maxX:s[2],maxY:s[3],value:o};i[r]=h,this.items_[X(o)]=h}this.rbush_.load(i)},n.prototype.remove=function(e){var t=X(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null},n.prototype.update=function(e,t){var i=this.items_[X(t)],r=[i.minX,i.minY,i.maxX,i.maxY];rr(r,e)||(this.remove(t),this.insert(e,t))},n.prototype.getAll=function(){var e=this.rbush_.all();return e.map(function(t){return t.value})},n.prototype.getInExtent=function(e){var t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]},i=this.rbush_.search(t);return i.map(function(r){return r.value})},n.prototype.forEach=function(e){return this.forEach_(this.getAll(),e)},n.prototype.forEachInExtent=function(e,t){return this.forEach_(this.getInExtent(e),t)},n.prototype.forEach_=function(e,t){for(var i,r=0,a=e.length;r<a;r++)if(i=t(e[r]),i)return i;return i},n.prototype.isEmpty=function(){return Ee(this.items_)},n.prototype.clear=function(){this.rbush_.clear(),this.items_={}},n.prototype.getExtent=function(e){var t=this.rbush_.toJSON();return ti(t.minX,t.minY,t.maxX,t.maxY,e)},n.prototype.concat=function(e){this.rbush_.load(e.rbush_.all());for(var t in e.items_)this.items_[t]=e.items_[t]},n}(),Ui=cs,K={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function ds(n,e){return[[-1/0,-1/0,1/0,1/0]]}var ps=!1;function _s(n,e,t,i,r,a,s){var o=new XMLHttpRequest;o.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()==Nt.ARRAY_BUFFER&&(o.responseType="arraybuffer"),o.withCredentials=ps,o.onload=function(h){if(!o.status||o.status>=200&&o.status<300){var l=e.getType(),u=void 0;l==Nt.JSON||l==Nt.TEXT?u=o.responseText:l==Nt.XML?(u=o.responseXML,u||(u=new DOMParser().parseFromString(o.responseText,"application/xml"))):l==Nt.ARRAY_BUFFER&&(u=o.response),u?a(e.readFeatures(u,{extent:t,featureProjection:r}),e.readProjection(u)):s()}else s()},o.onerror=s,o.send()}function $i(n,e){return function(t,i,r,a,s){var o=this;_s(n,e,t,i,r,function(h,l){o.addFeatures(h),a!==void 0&&a(h)},s||nr)}}var pr=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ft=function(n){pr(e,n);function e(t,i,r){var a=n.call(this,t)||this;return a.feature=i,a.features=r,a}return e}(xn),vs=function(n){pr(e,n);function e(t){var i=this,r=t||{};i=n.call(this,{attributions:r.attributions,interpolate:!0,projection:void 0,state:Sn.READY,wrapX:r.wrapX!==void 0?r.wrapX:!0})||this,i.on,i.once,i.un,i.loader_=nr,i.format_=r.format,i.overlaps_=r.overlaps===void 0?!0:r.overlaps,i.url_=r.url,r.loader!==void 0?i.loader_=r.loader:i.url_!==void 0&&(pt(i.format_,7),i.loader_=$i(i.url_,i.format_)),i.strategy_=r.strategy!==void 0?r.strategy:ds;var a=r.useSpatialIndex!==void 0?r.useSpatialIndex:!0;i.featuresRtree_=a?new Ui:null,i.loadedExtentsRtree_=new Ui,i.loadingExtentsCount_=0,i.nullGeometryFeatures_={},i.idIndex_={},i.uidIndex_={},i.featureChangeKeys_={},i.featuresCollection_=null;var s,o;return Array.isArray(r.features)?o=r.features:r.features&&(s=r.features,o=s.getArray()),!a&&s===void 0&&(s=new In(o)),o!==void 0&&i.addFeaturesInternal(o),s!==void 0&&i.bindFeaturesCollection_(s),i}return e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var i=X(t);if(!this.addToIndex_(i,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(i,t);var r=t.getGeometry();if(r){var a=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(a,t)}else this.nullGeometryFeatures_[i]=t;this.dispatchEvent(new ft(K.ADDFEATURE,t))},e.prototype.setupChangeEvents_=function(t,i){this.featureChangeKeys_[t]=[Qe(i,$t.CHANGE,this.handleFeatureChange_,this),Qe(i,En.PROPERTYCHANGE,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,i){var r=!0,a=i.getId();return a!==void 0&&(a.toString()in this.idIndex_?r=!1:this.idIndex_[a.toString()]=i),r&&(pt(!(t in this.uidIndex_),30),this.uidIndex_[t]=i),r},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var i=[],r=[],a=[],s=0,o=t.length;s<o;s++){var h=t[s],l=X(h);this.addToIndex_(l,h)&&r.push(h)}for(var s=0,u=r.length;s<u;s++){var h=r[s],l=X(h);this.setupChangeEvents_(l,h);var f=h.getGeometry();if(f){var c=f.getExtent();i.push(c),a.push(h)}else this.nullGeometryFeatures_[l]=h}this.featuresRtree_&&this.featuresRtree_.load(i,a);for(var s=0,d=r.length;s<d;s++)this.dispatchEvent(new ft(K.ADDFEATURE,r[s]))},e.prototype.bindFeaturesCollection_=function(t){var i=!1;this.addEventListener(K.ADDFEATURE,function(r){i||(i=!0,t.push(r.feature),i=!1)}),this.addEventListener(K.REMOVEFEATURE,function(r){i||(i=!0,t.remove(r.feature),i=!1)}),t.addEventListener(Ai.ADD,function(r){i||(i=!0,this.addFeature(r.element),i=!1)}.bind(this)),t.addEventListener(Ai.REMOVE,function(r){i||(i=!0,this.removeFeature(r.element),i=!1)}.bind(this)),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var i in this.featureChangeKeys_){var r=this.featureChangeKeys_[i];r.forEach(Ze)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){var a=function(h){this.removeFeatureInternal(h)}.bind(this);this.featuresRtree_.forEach(a);for(var s in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[s])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var o=new ft(K.CLEAR);this.dispatchEvent(o),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,i){var r=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(r,function(a){var s=a.getGeometry();if(s.intersectsCoordinate(t))return i(a)})},e.prototype.forEachFeatureInExtent=function(t,i){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,i);this.featuresCollection_&&this.featuresCollection_.forEach(i)},e.prototype.forEachFeatureIntersectingExtent=function(t,i){return this.forEachFeatureInExtent(t,function(r){var a=r.getGeometry();if(a.intersectsExtent(t)){var s=i(r);if(s)return s}})},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),Ee(this.nullGeometryFeatures_)||Tn(t,Cn(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var i=[];return this.forEachFeatureAtCoordinateDirect(t,function(r){i.push(r)}),i},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_?this.featuresRtree_.getInExtent(t):this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]},e.prototype.getClosestFeatureToCoordinate=function(t,i){var r=t[0],a=t[1],s=null,o=[NaN,NaN],h=1/0,l=[-1/0,-1/0,1/0,1/0],u=i||On;return this.featuresRtree_.forEachInExtent(l,function(f){if(u(f)){var c=f.getGeometry(),d=h;if(h=c.closestPointXY(r,a,o,h),h<d){s=f;var p=Math.sqrt(h);l[0]=r-p,l[1]=a-p,l[2]=r+p,l[3]=a+p}}}),s},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var i=this.idIndex_[t.toString()];return i!==void 0?i:null},e.prototype.getFeatureByUid=function(t){var i=this.uidIndex_[t];return i!==void 0?i:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var i=t.target,r=X(i),a=i.getGeometry();if(!a)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(i),this.nullGeometryFeatures_[r]=i);else{var s=a.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(s,i)):this.featuresRtree_&&this.featuresRtree_.update(s,i)}var o=i.getId();if(o!==void 0){var h=o.toString();this.idIndex_[h]!==i&&(this.removeFromIdIndex_(i),this.idIndex_[h]=i)}else this.removeFromIdIndex_(i),this.uidIndex_[r]=i;this.changed(),this.dispatchEvent(new ft(K.CHANGEFEATURE,i))},e.prototype.hasFeature=function(t){var i=t.getId();return i!==void 0?i in this.idIndex_:X(t)in this.uidIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&Ee(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,i,r){for(var a=this.loadedExtentsRtree_,s=this.strategy_(t,i,r),o=function(f,c){var d=s[f],p=a.forEachInExtent(d,function(_){return Yt(_.extent,d)});p||(++h.loadingExtentsCount_,h.dispatchEvent(new ft(K.FEATURESLOADSTART)),h.loader_.call(h,d,i,r,function(_){--this.loadingExtentsCount_,this.dispatchEvent(new ft(K.FEATURESLOADEND,void 0,_))}.bind(h),function(){--this.loadingExtentsCount_,this.dispatchEvent(new ft(K.FEATURESLOADERROR))}.bind(h)),a.insert(d,{extent:d.slice()}))},h=this,l=0,u=s.length;l<u;++l)o(l);this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0},e.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),n.prototype.refresh.call(this)},e.prototype.removeLoadedExtent=function(t){var i=this.loadedExtentsRtree_,r;i.forEachInExtent(t,function(a){if(rr(a.extent,t))return r=a,!0}),r&&i.remove(r)},e.prototype.removeFeature=function(t){if(!!t){var i=X(t);i in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[i]:this.featuresRtree_&&this.featuresRtree_.remove(t);var r=this.removeFeatureInternal(t);r&&this.changed()}},e.prototype.removeFeatureInternal=function(t){var i=X(t),r=this.featureChangeKeys_[i];if(!!r){r.forEach(Ze),delete this.featureChangeKeys_[i];var a=t.getId();return a!==void 0&&delete this.idIndex_[a.toString()],delete this.uidIndex_[i],this.dispatchEvent(new ft(K.REMOVEFEATURE,t)),t}},e.prototype.removeFromIdIndex_=function(t){var i=!1;for(var r in this.idIndex_)if(this.idIndex_[r]===t){delete this.idIndex_[r],i=!0;break}return i},e.prototype.setLoader=function(t){this.loader_=t},e.prototype.setUrl=function(t){pt(this.format_,7),this.url_=t,this.setLoader($i(t,this.format_))},e}(wn),gs=vs,si={exports:{}},_r=function(e,t){return function(){for(var r=new Array(arguments.length),a=0;a<r.length;a++)r[a]=arguments[a];return e.apply(t,r)}},ms=_r,_t=Object.prototype.toString;function oi(n){return Array.isArray(n)}function ri(n){return typeof n=="undefined"}function ys(n){return n!==null&&!ri(n)&&n.constructor!==null&&!ri(n.constructor)&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function vr(n){return _t.call(n)==="[object ArrayBuffer]"}function xs(n){return _t.call(n)==="[object FormData]"}function Ss(n){var e;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&vr(n.buffer),e}function Is(n){return typeof n=="string"}function Es(n){return typeof n=="number"}function gr(n){return n!==null&&typeof n=="object"}function ve(n){if(_t.call(n)!=="[object Object]")return!1;var e=Object.getPrototypeOf(n);return e===null||e===Object.prototype}function Ts(n){return _t.call(n)==="[object Date]"}function Cs(n){return _t.call(n)==="[object File]"}function ws(n){return _t.call(n)==="[object Blob]"}function mr(n){return _t.call(n)==="[object Function]"}function Os(n){return gr(n)&&mr(n.pipe)}function Rs(n){return _t.call(n)==="[object URLSearchParams]"}function Ls(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function Ds(){return typeof navigator!="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window!="undefined"&&typeof document!="undefined"}function hi(n,e){if(!(n===null||typeof n=="undefined"))if(typeof n!="object"&&(n=[n]),oi(n))for(var t=0,i=n.length;t<i;t++)e.call(null,n[t],t,n);else for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.call(null,n[r],r,n)}function ni(){var n={};function e(r,a){ve(n[a])&&ve(r)?n[a]=ni(n[a],r):ve(r)?n[a]=ni({},r):oi(r)?n[a]=r.slice():n[a]=r}for(var t=0,i=arguments.length;t<i;t++)hi(arguments[t],e);return n}function Fs(n,e,t){return hi(e,function(r,a){t&&typeof r=="function"?n[a]=ms(r,t):n[a]=r}),n}function As(n){return n.charCodeAt(0)===65279&&(n=n.slice(1)),n}var V={isArray:oi,isArrayBuffer:vr,isBuffer:ys,isFormData:xs,isArrayBufferView:Ss,isString:Is,isNumber:Es,isObject:gr,isPlainObject:ve,isUndefined:ri,isDate:Ts,isFile:Cs,isBlob:ws,isFunction:mr,isStream:Os,isURLSearchParams:Rs,isStandardBrowserEnv:Ds,forEach:hi,merge:ni,extend:Fs,trim:Ls,stripBOM:As},Et=V;function Hi(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var yr=function(e,t,i){if(!t)return e;var r;if(i)r=i(t);else if(Et.isURLSearchParams(t))r=t.toString();else{var a=[];Et.forEach(t,function(h,l){h===null||typeof h=="undefined"||(Et.isArray(h)?l=l+"[]":h=[h],Et.forEach(h,function(f){Et.isDate(f)?f=f.toISOString():Et.isObject(f)&&(f=JSON.stringify(f)),a.push(Hi(l)+"="+Hi(f))}))}),r=a.join("&")}if(r){var s=e.indexOf("#");s!==-1&&(e=e.slice(0,s)),e+=(e.indexOf("?")===-1?"?":"&")+r}return e},Ms=V;function we(){this.handlers=[]}we.prototype.use=function(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1};we.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)};we.prototype.forEach=function(e){Ms.forEach(this.handlers,function(i){i!==null&&e(i)})};var Ps=we,ks=V,Bs=function(e,t){ks.forEach(e,function(r,a){a!==t&&a.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[a])})},xr=function(e,t,i,r,a){return e.config=t,i&&(e.code=i),e.request=r,e.response=a,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e},Ns=xr,Sr=function(e,t,i,r,a){var s=new Error(e);return Ns(s,t,i,r,a)},bs=Sr,Gs=function(e,t,i){var r=i.config.validateStatus;!i.status||!r||r(i.status)?e(i):t(bs("Request failed with status code "+i.status,i.config,null,i.request,i))},pe=V,Ys=pe.isStandardBrowserEnv()?function(){return{write:function(t,i,r,a,s,o){var h=[];h.push(t+"="+encodeURIComponent(i)),pe.isNumber(r)&&h.push("expires="+new Date(r).toGMTString()),pe.isString(a)&&h.push("path="+a),pe.isString(s)&&h.push("domain="+s),o===!0&&h.push("secure"),document.cookie=h.join("; ")},read:function(t){var i=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),Ws=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)},Xs=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e},Us=Ws,$s=Xs,Hs=function(e,t){return e&&!Us(t)?$s(e,t):t},ze=V,Vs=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],js=function(e){var t={},i,r,a;return e&&ze.forEach(e.split(`
`),function(o){if(a=o.indexOf(":"),i=ze.trim(o.substr(0,a)).toLowerCase(),r=ze.trim(o.substr(a+1)),i){if(t[i]&&Vs.indexOf(i)>=0)return;i==="set-cookie"?t[i]=(t[i]?t[i]:[]).concat([r]):t[i]=t[i]?t[i]+", "+r:r}}),t},Vi=V,zs=Vi.isStandardBrowserEnv()?function(){var e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a"),i;function r(a){var s=a;return e&&(t.setAttribute("href",s),s=t.href),t.setAttribute("href",s),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return i=r(window.location.href),function(s){var o=Vi.isString(s)?r(s):s;return o.protocol===i.protocol&&o.host===i.host}}():function(){return function(){return!0}}();function li(n){this.message=n}li.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")};li.prototype.__CANCEL__=!0;var Oe=li,_e=V,Js=Gs,qs=Ys,Ks=yr,Zs=Hs,Qs=js,to=zs,Je=Sr,eo=Le,io=Oe,ji=function(e){return new Promise(function(i,r){var a=e.data,s=e.headers,o=e.responseType,h;function l(){e.cancelToken&&e.cancelToken.unsubscribe(h),e.signal&&e.signal.removeEventListener("abort",h)}_e.isFormData(a)&&delete s["Content-Type"];var u=new XMLHttpRequest;if(e.auth){var f=e.auth.username||"",c=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";s.Authorization="Basic "+btoa(f+":"+c)}var d=Zs(e.baseURL,e.url);u.open(e.method.toUpperCase(),Ks(d,e.params,e.paramsSerializer),!0),u.timeout=e.timeout;function p(){if(!!u){var v="getAllResponseHeaders"in u?Qs(u.getAllResponseHeaders()):null,g=!o||o==="text"||o==="json"?u.responseText:u.response,m={data:g,status:u.status,statusText:u.statusText,headers:v,config:e,request:u};Js(function(S){i(S),l()},function(S){r(S),l()},m),u=null}}if("onloadend"in u?u.onloadend=p:u.onreadystatechange=function(){!u||u.readyState!==4||u.status===0&&!(u.responseURL&&u.responseURL.indexOf("file:")===0)||setTimeout(p)},u.onabort=function(){!u||(r(Je("Request aborted",e,"ECONNABORTED",u)),u=null)},u.onerror=function(){r(Je("Network Error",e,null,u)),u=null},u.ontimeout=function(){var g=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",m=e.transitional||eo.transitional;e.timeoutErrorMessage&&(g=e.timeoutErrorMessage),r(Je(g,e,m.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",u)),u=null},_e.isStandardBrowserEnv()){var _=(e.withCredentials||to(d))&&e.xsrfCookieName?qs.read(e.xsrfCookieName):void 0;_&&(s[e.xsrfHeaderName]=_)}"setRequestHeader"in u&&_e.forEach(s,function(g,m){typeof a=="undefined"&&m.toLowerCase()==="content-type"?delete s[m]:u.setRequestHeader(m,g)}),_e.isUndefined(e.withCredentials)||(u.withCredentials=!!e.withCredentials),o&&o!=="json"&&(u.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&u.addEventListener("progress",e.onDownloadProgress),typeof e.onUploadProgress=="function"&&u.upload&&u.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(h=function(v){!u||(r(!v||v&&v.type?new io("canceled"):v),u.abort(),u=null)},e.cancelToken&&e.cancelToken.subscribe(h),e.signal&&(e.signal.aborted?h():e.signal.addEventListener("abort",h))),a||(a=null),u.send(a)})},W=V,zi=Bs,ro=xr,no={"Content-Type":"application/x-www-form-urlencoded"};function Ji(n,e){!W.isUndefined(n)&&W.isUndefined(n["Content-Type"])&&(n["Content-Type"]=e)}function ao(){var n;return(typeof XMLHttpRequest!="undefined"||typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]")&&(n=ji),n}function so(n,e,t){if(W.isString(n))try{return(e||JSON.parse)(n),W.trim(n)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(n)}var Re={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:ao(),transformRequest:[function(e,t){return zi(t,"Accept"),zi(t,"Content-Type"),W.isFormData(e)||W.isArrayBuffer(e)||W.isBuffer(e)||W.isStream(e)||W.isFile(e)||W.isBlob(e)?e:W.isArrayBufferView(e)?e.buffer:W.isURLSearchParams(e)?(Ji(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):W.isObject(e)||t&&t["Content-Type"]==="application/json"?(Ji(t,"application/json"),so(e)):e}],transformResponse:[function(e){var t=this.transitional||Re.transitional,i=t&&t.silentJSONParsing,r=t&&t.forcedJSONParsing,a=!i&&this.responseType==="json";if(a||r&&W.isString(e)&&e.length)try{return JSON.parse(e)}catch(s){if(a)throw s.name==="SyntaxError"?ro(s,this,"E_JSON_PARSE"):s}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};W.forEach(["delete","get","head"],function(e){Re.headers[e]={}});W.forEach(["post","put","patch"],function(e){Re.headers[e]=W.merge(no)});var Le=Re,oo=V,ho=Le,lo=function(e,t,i){var r=this||ho;return oo.forEach(i,function(s){e=s.call(r,e,t)}),e},Ir=function(e){return!!(e&&e.__CANCEL__)},qi=V,qe=lo,uo=Ir,fo=Le,co=Oe;function Ke(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new co("canceled")}var po=function(e){Ke(e),e.headers=e.headers||{},e.data=qe.call(e,e.data,e.headers,e.transformRequest),e.headers=qi.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),qi.forEach(["delete","get","head","post","put","patch","common"],function(r){delete e.headers[r]});var t=e.adapter||fo.adapter;return t(e).then(function(r){return Ke(e),r.data=qe.call(e,r.data,r.headers,e.transformResponse),r},function(r){return uo(r)||(Ke(e),r&&r.response&&(r.response.data=qe.call(e,r.response.data,r.response.headers,e.transformResponse))),Promise.reject(r)})},j=V,Er=function(e,t){t=t||{};var i={};function r(u,f){return j.isPlainObject(u)&&j.isPlainObject(f)?j.merge(u,f):j.isPlainObject(f)?j.merge({},f):j.isArray(f)?f.slice():f}function a(u){if(j.isUndefined(t[u])){if(!j.isUndefined(e[u]))return r(void 0,e[u])}else return r(e[u],t[u])}function s(u){if(!j.isUndefined(t[u]))return r(void 0,t[u])}function o(u){if(j.isUndefined(t[u])){if(!j.isUndefined(e[u]))return r(void 0,e[u])}else return r(void 0,t[u])}function h(u){if(u in t)return r(e[u],t[u]);if(u in e)return r(void 0,e[u])}var l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:h};return j.forEach(Object.keys(e).concat(Object.keys(t)),function(f){var c=l[f]||a,d=c(f);j.isUndefined(d)&&c!==h||(i[f]=d)}),i},Tr={version:"0.26.0"},_o=Tr.version,ui={};["object","boolean","number","function","string","symbol"].forEach(function(n,e){ui[n]=function(i){return typeof i===n||"a"+(e<1?"n ":" ")+n}});var Ki={};ui.transitional=function(e,t,i){function r(a,s){return"[Axios v"+_o+"] Transitional option '"+a+"'"+s+(i?". "+i:"")}return function(a,s,o){if(e===!1)throw new Error(r(s," has been removed"+(t?" in "+t:"")));return t&&!Ki[s]&&(Ki[s]=!0,console.warn(r(s," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(a,s,o):!0}};function vo(n,e,t){if(typeof n!="object")throw new TypeError("options must be an object");for(var i=Object.keys(n),r=i.length;r-- >0;){var a=i[r],s=e[a];if(s){var o=n[a],h=o===void 0||s(o,a,n);if(h!==!0)throw new TypeError("option "+a+" must be "+h);continue}if(t!==!0)throw Error("Unknown option "+a)}}var go={assertOptions:vo,validators:ui},Cr=V,mo=yr,Zi=Ps,Qi=po,De=Er,wr=go,Tt=wr.validators;function Qt(n){this.defaults=n,this.interceptors={request:new Zi,response:new Zi}}Qt.prototype.request=function(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=De(this.defaults,t),t.method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var i=t.transitional;i!==void 0&&wr.assertOptions(i,{silentJSONParsing:Tt.transitional(Tt.boolean),forcedJSONParsing:Tt.transitional(Tt.boolean),clarifyTimeoutError:Tt.transitional(Tt.boolean)},!1);var r=[],a=!0;this.interceptors.request.forEach(function(d){typeof d.runWhen=="function"&&d.runWhen(t)===!1||(a=a&&d.synchronous,r.unshift(d.fulfilled,d.rejected))});var s=[];this.interceptors.response.forEach(function(d){s.push(d.fulfilled,d.rejected)});var o;if(!a){var h=[Qi,void 0];for(Array.prototype.unshift.apply(h,r),h=h.concat(s),o=Promise.resolve(t);h.length;)o=o.then(h.shift(),h.shift());return o}for(var l=t;r.length;){var u=r.shift(),f=r.shift();try{l=u(l)}catch(c){f(c);break}}try{o=Qi(l)}catch(c){return Promise.reject(c)}for(;s.length;)o=o.then(s.shift(),s.shift());return o};Qt.prototype.getUri=function(e){return e=De(this.defaults,e),mo(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")};Cr.forEach(["delete","get","head","options"],function(e){Qt.prototype[e]=function(t,i){return this.request(De(i||{},{method:e,url:t,data:(i||{}).data}))}});Cr.forEach(["post","put","patch"],function(e){Qt.prototype[e]=function(t,i,r){return this.request(De(r||{},{method:e,url:t,data:i}))}});var yo=Qt,xo=Oe;function Rt(n){if(typeof n!="function")throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(r){e=r});var t=this;this.promise.then(function(i){if(!!t._listeners){var r,a=t._listeners.length;for(r=0;r<a;r++)t._listeners[r](i);t._listeners=null}}),this.promise.then=function(i){var r,a=new Promise(function(s){t.subscribe(s),r=s}).then(i);return a.cancel=function(){t.unsubscribe(r)},a},n(function(r){t.reason||(t.reason=new xo(r),e(t.reason))})}Rt.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};Rt.prototype.subscribe=function(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]};Rt.prototype.unsubscribe=function(e){if(!!this._listeners){var t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}};Rt.source=function(){var e,t=new Rt(function(r){e=r});return{token:t,cancel:e}};var So=Rt,Io=function(e){return function(i){return e.apply(null,i)}},Eo=V,To=function(e){return Eo.isObject(e)&&e.isAxiosError===!0},tr=V,Co=_r,ge=yo,wo=Er,Oo=Le;function Or(n){var e=new ge(n),t=Co(ge.prototype.request,e);return tr.extend(t,ge.prototype,e),tr.extend(t,e),t.create=function(r){return Or(wo(n,r))},t}var et=Or(Oo);et.Axios=ge;et.Cancel=Oe;et.CancelToken=So;et.isCancel=Ir;et.VERSION=Tr.version;et.all=function(e){return Promise.all(e)};et.spread=Io;et.isAxiosError=To;si.exports=et;si.exports.default=et;var Ro=si.exports;const fi=Ro.create({timeout:5e3});fi.interceptors.request.use(n=>n,n=>Promise.reject(n));fi.interceptors.response.use(n=>n,n=>(Pn.error(n.message),Promise.reject(n)));const Lo=()=>fi({url:"/typhoonData.json"}),Do={setup(n){const e=kn("map");Bn({});const t=async()=>{const{data:a}=await Lo();return a};(async()=>{const{points:a}=await t(),s=new fs,o=new gs;s.setSource(o);let h=0;const l=setInterval(()=>{if(h==a.length){clearInterval(l);return}const u=r(a,h);o.addFeature(u),h++},50);e.addLayer(s)})();const r=(a,s)=>{const o=[a[s].lng,a[s].lat],h=new Un({geometry:new Rn(Ln(o))});return h.setStyle(new la({image:new hr({fill:new lr({color:"red"}),radius:4})})),h.set("typhoonPoint",!0),h};return(a,s)=>Nn("",!0)}},Fo={setup(n){const e=[113.27,23.1],t="http://t{0-7}.tianditu.gov.cn/vec_w/wmts?tk=40e50cca6823476482e8721bb2eee900",i="http://t{0-7}.tianditu.gov.cn/cva_w/wmts?tk=40e50cca6823476482e8721bb2eee900",r="vec",a="cva",s="\u52A0\u8F7DWMTS\u5929\u5730\u56FE";return(o,h)=>{const l=Fn,u=An,f=Mn,c=Dn;return bn(),Gn(c,null,{default:Xe(()=>[xt(l,{center:e,zoom:5}),xt(f,null,{default:Xe(()=>[xt(u,{url:t,attributions:s,layer:r})]),_:1}),xt(f,null,{default:Xe(()=>[xt(u,{url:i,attributions:s,layer:a})]),_:1}),xt(Do)]),_:1})}}};var ko=Fo;export{ko as default};
